<!DOCTYPE html>
<!-- saved from url=(0054)https://docs.anza.xyz/proposals/versioned-transactions -->
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-proposals/versioned-transactions" data-theme="light" data-rh="lang,dir,class"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="Docusaurus v2.2.0">
<title>Versioned Transactions - v0: Address Lookup Tables | Agave</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.anza.xyz/proposals/versioned-transactions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Versioned Transactions - v0: Address Lookup Tables | Agave"><meta data-rh="true" name="description" content="Problem"><meta data-rh="true" property="og:description" content="Problem"><link data-rh="true" rel="icon" href="https://docs.anza.xyz/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.anza.xyz/proposals/versioned-transactions"><link data-rh="true" rel="alternate" href="https://docs.anza.xyz/proposals/versioned-transactions" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.anza.xyz/de/proposals/versioned-transactions" hreflang="de"><link data-rh="true" rel="alternate" href="https://docs.anza.xyz/es/proposals/versioned-transactions" hreflang="es"><link data-rh="true" rel="alternate" href="https://docs.anza.xyz/ru/proposals/versioned-transactions" hreflang="ru"><link data-rh="true" rel="alternate" href="https://docs.anza.xyz/ar/proposals/versioned-transactions" hreflang="ar"><link data-rh="true" rel="alternate" href="https://docs.anza.xyz/proposals/versioned-transactions" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://fq12isjr4b-dsn.algolia.net/" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Agave" href="https://docs.anza.xyz/opensearch.xml">
<link rel="stylesheet" href="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><link rel="stylesheet" href="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/styles.a178793d.css">
<link rel="preload" href="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/runtime~main.e7cb6a47.js.Без названия" as="script">
<link rel="preload" href="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/main.4236a140.js.Без названия" as="script">
<meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/e6f4121d.1b90b826.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/37ee2579.52dda0b1.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/f23b8a32.acc5f81f.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/be050efd.0f03f092.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/49951a96.70bdb189.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/90f9d962.b3eaa036.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/3e5d84f4.9a5c405d.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/06e140c1.d4be6855.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/5e46da22.eac1b846.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/aabd1d34.48872d0a.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/0a733acb.e47a19e3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/cdfbe429.61ec7732.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/2e3f7a0b.6fdd4038.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/982bea2d.d7c1771d.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/8d67321d.65f5248b.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/c68172e6.7afa76ed.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/6637e95a.4cb6e0ea.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/1be78505.d89d2de9.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/22b7c832.d8b004c7.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/935f2afb.eed3b8b3.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/4e6ff2c2.5c6a7751.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/17896441.9518be0c.js"><link rel="prefetch" href="https://docs.anza.xyz/assets/js/3a0a7a24.c46f9a33.js"></head>
<body class="" data-rh="class" style="overflow: visible;">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="https://docs.anza.xyz/proposals/versioned-transactions#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="https://docs.anza.xyz/"><div class="navbar__logo"><img src="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/logo-horizontal.svg" alt="Anza Logo" class="themedImage_ToTc themedImage--light_HNdA"></div></a><a class="navbar__item navbar__link" href="https://docs.anza.xyz/cli">CLI</a><a class="navbar__item navbar__link" href="https://docs.anza.xyz/architecture">Architecture</a><a class="navbar__item navbar__link" href="https://docs.anza.xyz/operations">Operating a Validator</a><div class="navbar__item dropdown dropdown--hoverable"><a href="https://docs.anza.xyz/proposals/versioned-transactions#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="https://docs.anza.xyz/proposals">Proposals</a></li><li><a href="https://spl.solana.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Solana Program Library<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="https://docs.anza.xyz/proposals/versioned-transactions#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="https://docs.anza.xyz/proposals/versioned-transactions" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="https://docs.anza.xyz/de/proposals/versioned-transactions" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="https://docs.anza.xyz/es/proposals/versioned-transactions" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="https://docs.anza.xyz/ru/proposals/versioned-transactions" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru">Русский</a></li><li><a href="https://docs.anza.xyz/ar/proposals/versioned-transactions" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li></ul></div><a href="https://solana.com/discord" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-link-icon header-discord-link" aria-label="Solana Tech Discord"></a><a href="https://github.com/anza-xyz/agave/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-link-icon header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP" type="button" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a href="https://docs.anza.xyz/proposals/versioned-transactions#" class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true">System Design Proposals</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="https://docs.anza.xyz/proposals/accepted-design-proposals">Accepted Proposals</a><button aria-label="Toggle the collapsible sidebar category &#39;Accepted Proposals&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/accepted-design-proposals">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/accounts-db-replication">AccountsDB Replication for RPC Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/bankless-leader">Bankless Leader</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/block-confirmation">Block Confirmation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/blockstore-rocksdb-compaction">Optimize RocksDB Compaction for Solana BlockStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/cluster-test-framework">Cluster Test Framework</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/comprehensive-compute-fees">Comprehensive Compute Fees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/embedding-move">Embedding the Move Language</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/fee_transaction_priority">Fee Transaction Priority</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/handle-duplicate-block">Handle Duplicate Block</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/interchain-transaction-verification">Inter-chain Transaction Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/ledger-replication-to-implement">Ledger Replication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/log_data">Program log binary data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/off-chain-message-signing">Off-chain message signing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/optimistic-confirmation-and-slashing">Optimistic Confirmation and Slashing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/optimistic-transaction-propagation-signal">Optimistic Transaction Propagation Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/optimistic_confirmation">Optimistic Confirmation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/partitioned-inflationary-rewards-distribution">Partitioned Inflationary Rewards Distribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/program-instruction-macro">Program Instruction Macro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/return-data">Return data from SBF programs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/rip-curl">RiP Curl: low-latency, transaction-oriented RPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/rust-clients">Rust Clients</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/simple-payment-and-state-verification">Simple Payment and State Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/slashing">Slashing rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/snapshot-verification">Snapshot Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/tick-verification">Tick Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/timely-vote-credits">Timely Vote Credits</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/validator-proposal">Validator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="https://docs.anza.xyz/proposals/versioned-transactions">Versioned Transactions - v0: Address Lookup Tables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.anza.xyz/proposals/vote-signing-to-implement">Secure Vote Signing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.anza.xyz/implemented-proposals/">Implemented Proposals</a><button aria-label="Toggle the collapsible sidebar category &#39;Implemented Proposals&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="https://docs.anza.xyz/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">System Design Proposals</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.anza.xyz/proposals/accepted-design-proposals"><span itemprop="name">Accepted Proposals</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Versioned Transactions - v0: Address Lookup Tables</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Versioned Transactions - v0: Address Lookup Tables</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="problem">Problem<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#problem" title="Direct link to heading">​</a></h2><p>Messages transmitted to Solana validators must not exceed the IPv6 MTU size to
ensure fast and reliable network transmission of cluster info over UDP.
Solana's networking stack uses a conservative MTU size of 1280 bytes which,
after accounting for headers, leaves 1232 bytes for packet data like serialized
transactions.</p><p>Developers building applications on Solana must design their on-chain program
interfaces within the above transaction size limit constraint. One common
work-around is to store state temporarily on-chain and consume that state in
later transactions. This is the approach used by the BPF loader program for
deploying Solana programs.</p><p>However, this workaround doesn't work well when developers compose many on-chain
programs in a single atomic transaction. With more composition comes more
account inputs, each of which takes up 32 bytes. There is currently no available
workaround for increasing the number of accounts used in a single transaction
since each transaction must list all accounts that it needs to properly lock
accounts for parallel execution. Therefore the current cap is about 35 accounts
after accounting for signatures and other transaction metadata.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="proposed-solution">Proposed Solution<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#proposed-solution" title="Direct link to heading">​</a></h2><ol><li>Introduce a new program which manages on-chain address lookup tables</li><li>Add a new transaction format which can make use of on-chain
address lookup tables to efficiently load more accounts in a single transaction.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="address-lookup-table-program">Address Lookup Table Program<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#address-lookup-table-program" title="Direct link to heading">​</a></h3><p>Here we describe a program-based solution to the problem, whereby a protocol
developer or end-user can create collections of related addresses on-chain for
concise use in a transaction's account inputs.</p><p>After addresses are stored on-chain in an address lookup table account, they may be
succinctly referenced in a transaction using a 1-byte u8 index rather than a
full 32-byte address. This will require a new transaction format to make use of
these succinct references as well as runtime handling for looking up and loading
addresses from the on-chain lookup tables.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="state">State<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#state" title="Direct link to heading">​</a></h4><p>Address lookup tables must be rent-exempt when initialized and after
each time new addresses are appended. Lookup tables can either be extended
from an on-chain buffered list of addresses or directly by appending
addresses through instruction data. Newly appended addresses require
one slot to warmup before being available to transactions for lookups.</p><p>Since transactions use a <code>u8</code> index to look up addresses, address tables can
store up to 256 addresses each. In addition to stored addresses, address table
accounts also tracks various metadata explained below.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #bfc7d5; --prism-background-color: #292d3e;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// The maximum number of addresses that a lookup table can hold</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">const</span><span class="token plain"> </span><span class="token constant" style="color: rgb(130, 170, 255);">LOOKUP_TABLE_MAX_ADDRESSES</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">usize</span><span class="token plain"> </span><span class="token operator" style="color: rgb(137, 221, 255);">=</span><span class="token plain"> </span><span class="token number" style="color: rgb(247, 140, 108);">256</span><span class="token punctuation" style="color: rgb(199, 146, 234);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// The serialized size of lookup table metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">const</span><span class="token plain"> </span><span class="token constant" style="color: rgb(130, 170, 255);">LOOKUP_TABLE_META_SIZE</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">usize</span><span class="token plain"> </span><span class="token operator" style="color: rgb(137, 221, 255);">=</span><span class="token plain"> </span><span class="token number" style="color: rgb(247, 140, 108);">56</span><span class="token punctuation" style="color: rgb(199, 146, 234);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color: rgb(255, 203, 107);">LookupTableMeta</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(199, 146, 234);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// Lookup tables cannot be closed until the deactivation slot is</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// no longer "recent" (not accessible in the `SlotHashes` sysvar).</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> deactivation_slot</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Slot</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// The slot that the table was last extended. Address tables may</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// only be used to lookup addresses that were extended before</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// the current bank's slot.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> last_extended_slot</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Slot</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// The start index where the table was last extended from during</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// the `last_extended_slot`.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> last_extended_slot_start_index</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">u8</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// Authority address which must sign for each modification.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> authority</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Option</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token class-name" style="color: rgb(255, 203, 107);">Pubkey</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// Raw list of addresses follows this serialized structure in</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// the account's data, starting from `LOOKUP_TABLE_META_SIZE`.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(199, 146, 234);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cleanup">Cleanup<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#cleanup" title="Direct link to heading">​</a></h4><p>Once an address lookup table is no longer needed, it can be deactivated and closed
to have its rent balance reclaimed. Address lookup tables may not be recreated
at the same address because each new lookup table must be initialized at an address
derived from a recent slot.</p><p>Address lookup tables can be deactivated at any time but can continue to be used
by transactions until the deactivation slot is no longer present in the slot hashes
sysvar. This cool-down period ensures that in-flight transactions cannot be
censored and that address lookup tables cannot be closed and recreated for the same
slot.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="versioned-transactions">Versioned Transactions<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#versioned-transactions" title="Direct link to heading">​</a></h3><p>In order to support address table lookups, the structure of serialized
transactions must be modified. The new transaction format should not
affect transaction processing in the Solana program runtime beyond the
increased capacity for accounts and program invocations. Invoked
programs will be unaware of which transaction format was used.</p><p>The new transaction format must be distinguished from the current transaction
format. Current transactions can fit at most 19 signatures (64-bytes each) but
the message header encodes <code>num_required_signatures</code> as a <code>u8</code>. Since the upper
bit of the <code>u8</code> will never be set for a valid transaction, we can enable it to
denote whether a transaction should be decoded with the versioned format or not.</p><p>The original transaction format will be referred to as the legacy transaction
version and the first versioned transaction format will start at version 0.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-transaction-format">New Transaction Format<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#new-transaction-format" title="Direct link to heading">​</a></h4><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #bfc7d5; --prism-background-color: #292d3e;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[derive(Serialize, Deserialize)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color: rgb(255, 203, 107);">VersionedTransaction</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(199, 146, 234);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// List of signatures</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[serde(with = </span><span class="token attribute attr-name string" style="color: rgb(195, 232, 141);">"short_vec"</span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> signatures</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Vec</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token class-name" style="color: rgb(255, 203, 107);">Signature</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// Message to sign.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> message</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">VersionedMessage</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(199, 146, 234);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// Uses custom serialization. If the first bit is set, the remaining bits</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// in the first byte will encode a version number. If the first bit is not</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// set, the first byte will be treated as the first byte of an encoded</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// legacy message.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">enum</span><span class="token plain"> </span><span class="token type-definition class-name" style="color: rgb(255, 203, 107);">VersionedMessage</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(199, 146, 234);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token class-name" style="color: rgb(255, 203, 107);">Legacy</span><span class="token punctuation" style="color: rgb(199, 146, 234);">(</span><span class="token class-name" style="color: rgb(255, 203, 107);">LegacyMessage</span><span class="token punctuation" style="color: rgb(199, 146, 234);">)</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">    </span><span class="token constant" style="color: rgb(130, 170, 255);">V0</span><span class="token punctuation" style="color: rgb(199, 146, 234);">(</span><span class="token namespace" style="color: rgb(178, 204, 214);">v0</span><span class="token namespace punctuation" style="color: rgb(199, 146, 234);">::</span><span class="token class-name" style="color: rgb(255, 203, 107);">Message</span><span class="token punctuation" style="color: rgb(199, 146, 234);">)</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(199, 146, 234);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// The structure of the new v0 Message</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[derive(Serialize, Deserialize)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color: rgb(255, 203, 107);">Message</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(199, 146, 234);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// unchanged</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> header</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">MessageHeader</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// unchanged</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[serde(with = </span><span class="token attribute attr-name string" style="color: rgb(195, 232, 141);">"short_vec"</span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> account_keys</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Vec</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token class-name" style="color: rgb(255, 203, 107);">Pubkey</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// unchanged</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> recent_blockhash</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Hash</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// unchanged</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">//</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// # Notes</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">//</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// Account and program indexes will index into the list of addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">// constructed from the concatenation of three key lists:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">//   1) message `account_keys`</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">//   2) ordered list of keys loaded from address table `writable_indexes`</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">//   3) ordered list of keys loaded from address table `readonly_indexes`</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[serde(with = </span><span class="token attribute attr-name string" style="color: rgb(195, 232, 141);">"short_vec"</span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> instructions</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Vec</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token class-name" style="color: rgb(255, 203, 107);">CompiledInstruction</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// List of address table lookups used to load additional accounts</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// for this transaction.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[serde(with = </span><span class="token attribute attr-name string" style="color: rgb(195, 232, 141);">"short_vec"</span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> address_table_lookups</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Vec</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token class-name" style="color: rgb(255, 203, 107);">MessageAddressTableLookup</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(199, 146, 234);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// Address table lookups describe an on-chain address lookup table to use</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// for loading more readonly and writable accounts in a single tx.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[derive(Serialize, Deserialize)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> </span><span class="token keyword" style="font-style: italic;">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color: rgb(255, 203, 107);">MessageAddressTableLookup</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(199, 146, 234);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// Address lookup table account key</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> account_key</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Pubkey</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// List of indexes used to load writable account addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[serde(with = </span><span class="token attribute attr-name string" style="color: rgb(195, 232, 141);">"short_vec"</span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> writable_indexes</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Vec</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token keyword" style="font-style: italic;">u8</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token comment" style="color: rgb(105, 112, 152); font-style: italic;">/// List of indexes used to load readonly account addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">#[serde(with = </span><span class="token attribute attr-name string" style="color: rgb(195, 232, 141);">"short_vec"</span><span class="token attribute attr-name" style="color: rgb(255, 203, 107);">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain">  </span><span class="token keyword" style="font-style: italic;">pub</span><span class="token plain"> readonly_indexes</span><span class="token punctuation" style="color: rgb(199, 146, 234);">:</span><span class="token plain"> </span><span class="token class-name" style="color: rgb(255, 203, 107);">Vec</span><span class="token operator" style="color: rgb(137, 221, 255);">&lt;</span><span class="token keyword" style="font-style: italic;">u8</span><span class="token operator" style="color: rgb(137, 221, 255);">&gt;</span><span class="token punctuation" style="color: rgb(199, 146, 234);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(191, 199, 213);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(199, 146, 234);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="size-changes">Size changes<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#size-changes" title="Direct link to heading">​</a></h4><ul><li>1 extra byte for the <code>version</code> field</li><li>1 extra byte for the <code>address_table_lookups</code> length</li><li>34 extra bytes for each address table lookup which includes 32 bytes for the
address of the table and a byte each for the lengths of the <code>writable_indexes</code>
and <code>readonly_indexes</code> fields</li><li>1 extra byte for each lookup table index</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cost">Cost<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#cost" title="Direct link to heading">​</a></h4><p>Address lookups require extra computational overhead during transaction
processing, but also reduce network bandwidth due to smaller transactions and
therefore smaller blocks.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-changes">Metadata changes<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#metadata-changes" title="Direct link to heading">​</a></h4><p>Each resolved address from an address lookup table should be stored in
the transaction metadata for quick reference. This will avoid the need for
clients to make multiple RPC round trips to fetch all accounts loaded by a
v0 transaction. It will also make it easier to use the ledger tool to
analyze account access patterns.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rpc-changes">RPC changes<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#rpc-changes" title="Direct link to heading">​</a></h4><p>Fetched transaction responses will likely require a new version field to
indicate to clients which transaction structure to use for deserialization.
Clients using pre-existing RPC methods will receive error responses when
attempting to fetch a versioned transaction which will indicate that they
must upgrade.</p><p>The RPC API should also support an option for returning fully expanded
transactions to abstract away the address lookup table details from
downstream clients.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitations">Limitations<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#limitations" title="Direct link to heading">​</a></h3><ul><li>Max of 256 unique accounts may be loaded by a transaction because <code>u8</code>
is used by compiled instructions to index into transaction message <code>account_keys</code>.</li><li>Address lookup tables can hold up to 256 entries because lookup table indexes are also <code>u8</code>.</li><li>Transaction signers may not be loaded through an address lookup table, the full
address of each signer must be serialized in the transaction. This ensures that
the performance of transaction signature checks is not affected.</li><li>Hardware wallets will not be able to display details about accounts referenced
through address lookup tables due to inability to verify on-chain data.</li><li>Only single level address lookup tables can be used. Recursive lookups will not be supported.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-concerns">Security Concerns<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#security-concerns" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lookup-table-re-initialization">Lookup table re-initialization<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#lookup-table-re-initialization" title="Direct link to heading">​</a></h3><p>If an address lookup table can be closed and re-initialized with new addresses,
any client which is unaware of the change could inadvertently lookup unexpected
addresses. To avoid this, all address lookup tables must be initialized at an
address derived from a recent slot and they cannot be closed until the slot
used for deactivation is no longer in the slot hashes sysvar.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="resource-consumption">Resource consumption<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#resource-consumption" title="Direct link to heading">​</a></h3><p>Enabling more account inputs in a transaction allows for more program
invocations, write-locks, and data reads / writes. Before address tables are
enabled, transaction-wide compute limits and increased costs for write locks and
data reads are required.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="front-running">Front running<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#front-running" title="Direct link to heading">​</a></h3><p>If the addresses listed within an address lookup table are mutable, front
running attacks could modify which addresses are resolved for a later
transaction. For this reason, address lookup tables are append-only and may
only be closed if it's no longer possible to create a new lookup table at the
same derived address.</p><p>Additionally, a malicious actor could try to fork the chain immediately after a
new address lookup table account is added to a block. If successful, they could
add a different unexpected table entry in the fork. In order to deter this attack,
clients should wait for address lookup tables to be finalized before using them in a
transaction. Clients may also append integrity check instructions to the
transaction which verify that the correct accounts are looked up.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="denial-of-service">Denial of service<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#denial-of-service" title="Direct link to heading">​</a></h3><p>Address lookup table accounts may be read very frequently and will therefore
be a more high profile target for denial of service attacks through write locks
similar to sysvar accounts.</p><p>For this reason, special handling should be given to address lookup tables.
When an address lookup table is used to lookup addresses for a transaction,
it can be loaded without waiting for a read lock. To avoid race conditions,
only the addresses appended in previous blocks can be used for lookups and
deactivation requires a cool-down period.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="duplicate-accounts">Duplicate accounts<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#duplicate-accounts" title="Direct link to heading">​</a></h3><p>Transactions may not load an account more than once whether directly through
<code>account_keys</code> or indirectly through <code>address_table_lookups</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-proposals">Other Proposals<a class="hash-link" href="https://docs.anza.xyz/proposals/versioned-transactions#other-proposals" title="Direct link to heading">​</a></h2><ol><li>Account prefixes</li></ol><p>Needing to pre-register accounts in an on-chain address lookup table is cumbersome
because it adds an extra step for transaction processing. Instead, Solana
transactions could use variable length address prefixes to specify accounts.
These prefix shortcuts can save on data usage without needing to setup on-chain
state.</p><p>However, this model requires nodes to keep a mapping of prefixes to active account
addresses. Attackers can create accounts with the same prefix as a popular account
to disrupt transactions.</p><ol start="2"><li>Transaction builder program</li></ol><p>Solana can provide a new on-chain program which allows "Big" transactions to be
constructed on-chain by normal transactions. Once the transaction is
constructed, a final "Execute" transaction can trigger a node to process the big
transaction as a normal transaction without needing to fit it into an MTU sized
packet.</p><p>The UX of this approach is tricky. A user could in theory sign a big transaction
but it wouldn't be great if they had to use their wallet to sign multiple
transactions to build that transaction that they already signed and approved. This
could be a use-case for transaction relay services, though. A user could pay a
relayer to construct the large pre-signed transaction on-chain for them.</p><p>In order to prevent the large transaction from being reconstructed and replayed,
its message hash will need to be added to the status cache when executed.</p><ol start="3"><li>Epoch account indexes</li></ol><p>Similarly to leader schedule calculation, validators could create a global index
of the most accessed accounts in the previous epoch and make that index
available to transactions in the following epoch.</p><p>This approach has a downside of only updating the index at epoch boundaries
which means there would be a few day delay before popular new accounts could be
referenced. It also needs to be consistently generated by all validators by
using some criteria like adding accounts in order by access count.</p><ol start="4"><li>Address lists</li></ol><p>Extend the transaction structure to support addresses that, when loaded, expand
to a list of addresses. After expansion, all account inputs are concatenated to
form a single list of account keys which can be indexed into by instructions.
Address lists would likely need to be immutable to prevent attacks. They would
also need to be limited in length to limit resource consumption.</p><p>This proposal can be thought of a special case of the proposed index account
approach. Since the full account list would be expanded, there's no need to add
additional offsets that use up the limited space in a serialized transaction.
However, the expected size of an address list may need to be encoded into the
transaction to aid the sanitization of account indexes. We would also need to
encode how many addresses in the list should be loaded as readonly vs
read-write. Lastly, special attention must be given to watch out for addresses
that exist in multiple account lists.</p><ol start="5"><li>Increase transaction size</li></ol><p>Significantly larger serialized transactions have an increased likelihood of being
dropped over the wire but this might not be a big issue since clients can retry
transactions anyways. The only time validators need to send individual transactions
over the network is when a leader forwards unprocessed transactions to the next
leader.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="https://docs.anza.xyz/proposals/validator-proposal"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Validator</div></a><a class="pagination-nav__link pagination-nav__link--next" href="https://docs.anza.xyz/proposals/vote-signing-to-implement"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Secure Vote Signing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#problem" class="table-of-contents__link toc-highlight table-of-contents__link--active">Problem</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#proposed-solution" class="table-of-contents__link toc-highlight">Proposed Solution</a><ul><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#address-lookup-table-program" class="table-of-contents__link toc-highlight">Address Lookup Table Program</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#versioned-transactions" class="table-of-contents__link toc-highlight">Versioned Transactions</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#limitations" class="table-of-contents__link toc-highlight">Limitations</a></li></ul></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#security-concerns" class="table-of-contents__link toc-highlight">Security Concerns</a><ul><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#lookup-table-re-initialization" class="table-of-contents__link toc-highlight">Lookup table re-initialization</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#resource-consumption" class="table-of-contents__link toc-highlight">Resource consumption</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#front-running" class="table-of-contents__link toc-highlight">Front running</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#denial-of-service" class="table-of-contents__link toc-highlight">Denial of service</a></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#duplicate-accounts" class="table-of-contents__link toc-highlight">Duplicate accounts</a></li></ul></li><li><a href="https://docs.anza.xyz/proposals/versioned-transactions#other-proposals" class="table-of-contents__link toc-highlight">Other Proposals</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Documentation</h4><ul class="footer__items"><li class="footer__item"><a href="https://solana.com/developers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developers »</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.anza.xyz/operations">Running a Validator</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.anza.xyz/cli">Command Line</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.anza.xyz/architecture">Architecture</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://solana.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Exchange »</a></li><li class="footer__item"><a href="https://github.com/anza-xyz/agave" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub »</a></li><li class="footer__item"><a href="https://solana.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord »</a></li><li class="footer__item"><a href="https://solana.com/twitter" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter »</a></li><li class="footer__item"><a href="https://forum.solana.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum »</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a href="https://solana.com/docs/terminology" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terminology »</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.anza.xyz/proposals">Proposals</a></li><li class="footer__item"><a href="https://spl.solana.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Solana Program Library »</a></li></ul></div></div><div class="text--center"><div>Copyright © 2025 Anza</div></div></div></footer></div>
<script src="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/runtime~main.e7cb6a47.js.Без названия"></script>
<script src="./Versioned Transactions - v0_ Address Lookup Tables _ Agave_files/main.4236a140.js.Без названия"></script>

</body></html>