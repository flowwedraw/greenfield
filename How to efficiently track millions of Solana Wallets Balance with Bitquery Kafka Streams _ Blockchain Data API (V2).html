<!DOCTYPE html>
<!-- saved from url=(0072)https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/ -->
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-usecases/track-millions-of-solana-wallets" data-has-hydrated="true" data-theme="dark" data-rh="lang,dir,class,data-has-hydrated"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="Docusaurus v2.4.3">
<title>How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams | Blockchain Data API (V2)</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.bitquery.io/img/heroImage4.png"><meta data-rh="true" name="twitter:image" content="https://docs.bitquery.io/img/heroImage4.png"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><link data-rh="true" rel="icon" href="https://docs.bitquery.io/img/favicon.ico"><link rel="alternate" type="application/rss+xml" href="https://docs.bitquery.io/blog/rss.xml" title="Blockchain Data API (V2) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="https://docs.bitquery.io/blog/atom.xml" title="Blockchain Data API (V2) Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com/">
<link rel="preconnect" href="https://www.googletagmanager.com/">
<script type="text/javascript" async="" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/js"></script><script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/fb.js.Без названия" type="text/javascript" id="hs-ads-pixel-6314272" data-ads-portal-id="6314272" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/web-interactives-embed.js.Без названия" type="text/javascript" id="hubspot-web-interactives-loader" crossorigin="anonymous" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/leadflows.js.Без названия" type="text/javascript" id="LeadFlows-6314272" crossorigin="anonymous" data-leadin-portal-id="6314272" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/banner.js.Без названия" type="text/javascript" id="cookieBanner-6314272" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/6314272.js.Без названия" type="text/javascript" id="hs-analytics"></script><script async="" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/gtm.js.Без названия"></script><script async="" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/js(1)"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZWB80TDH9J",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com/">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-5GC69JH6",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>




<script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/embed.min.js.Без названия" async="" id="Vz0cwoEYRJW6n5B2JeSeu" domain="www.chatbase.co"></script>
<script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/chatbase-open.js.Без названия" defer="defer"></script><link rel="stylesheet" href="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/styles.2db95959.css">
<link rel="preload" href="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/runtime~main.94f1a4d2.js.Без названия" as="script">
<link rel="preload" href="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/main.19751415.js.Без названия" as="script">
<meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><style id="_goober"> .go2933276541{position:fixed;display:block;width:100%;height:0px;margin:0px;padding:0px;overflow:visible;transform-style:preserve-3d;background:transparent;backface-visibility:hidden;pointer-events:none;left:0px;z-index:9998;}.go2369186930{top:0px;z-index:9999;height:100%;width:100%;}.go1348078617{bottom:0px;}.go2417249464{position:fixed;z-index:9989;}.go3921366393{left:0;bottom:0;}.go3967842156{right:0;bottom:0;}.go613305155{left:0;top:0;}.go471583506{right:0;top:0;}.go3670563033{position:relative;overflow:hidden;display:none;}.go1041095097{display:block;}.go1632949049{position:absolute;pointer-events:none;width:101vw;height:101vh;background:rgba(0,0,0,0.7);opacity:0;z-index:-1;}.go2512015367{z-index:99998;opacity:0.8;visibility:visible;pointer-events:all;cursor:pointer;}.go1432718904{overflow:hidden;}.go812842568{display:block !important;position:static !important;box-sizing:border-box !important;background:transparent !important;border:none;min-height:0px !important;max-height:none !important;margin:0px;padding:0px !important;height:100% !important;width:1px !important;max-width:100% !important;min-width:100% !important;}.go4194603687{z-index:99999;visibility:hidden;position:absolute;inset:50vh auto auto 50%;transform:translate(-50%,-50%);left:50%;top:150%;pointer-events:none;max-height:95%;max-width:95%;}.go4258295619{pointer-events:auto !important;visibility:visible;top:50%;transition:top 0.75s linear(0,0.006,0.023 2.2%,0.096 4.8%,0.532 15.4%,0.72 21%,0.793,0.853 26.7%,0.902,0.941,0.968 36.2%,0.987 39.7%,1 43.7%,1.007 48.3%,1.009 55.3%,1.002 78.2%,1 );}.go456419034{transition:opacity 0.3s ease-in;}.go3128134379{pointer-events:auto !important;visibility:visible !important;max-height:95vh !important;transition:max-height 1s ease-in;}.go494047706{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;}.go2481764524{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;bottom:0px;}.go2685733372{visibility:hidden;}.go2985984737{visibility:visible !important;}.go3281949485{pointer-events:auto !important;visibility:visible !important;max-height:95vh !important;transform:none !important;}.go3508454897{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;transition:transform 1s linear(0,0.006,0.022 2.3%,0.091 5.1%,0.18 7.6%,0.508 16.3%,0.607,0.691,0.762,0.822 28.4%,0.872,0.912 35.1%,0.944 38.9%,0.968 43%,0.985 47.6%,0.996 53.1%,1.001 58.4%,1.003 65.1%,1 );}.go988075951{z-index:9999;position:fixed;left:10px;top:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go2699082514{z-index:9999;position:fixed;right:10px;top:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go1595992025{z-index:9999;position:fixed;left:10px;bottom:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go1222083472{z-index:9999;position:fixed;right:10px;bottom:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go722322694{transition:none !important;}.go26732895{cursor:pointer;}.go2083580917{display:flex;justify-content:center;align-items:center;}</style><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/a468e46b.901c42bb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/da57af4e.999dd7e9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/0e384e19.1ec5afa4.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/c4f5d8e4.e98f0852.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/ad776868.2e6af93e.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/137b7510.c0c07b49.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/951a1f5d.00934596.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b70f6985.55e46717.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4144071c.ce143a28.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4bd2478d.bd11c6a0.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b2389277.bfe41362.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/3d6d56b6.86cc964c.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b9910d88.1e97d040.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/41fa0d41.e7b7df6f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/6d84b776.e0364f6a.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/49bb8dc3.e1fca388.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b8418c0b.68b78aa6.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4ad85961.66bc2132.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/da7cc36a.89881bfa.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/83e8900e.b124aecc.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/fc0e69bb.868b5e1d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/92040533.ecb524a3.js"><script async="" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/js(2)"></script><script type="text/javascript" async="" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/f.txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/7b761405.ad3d5647.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/90a4126b.8589612b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/620cd139.7785e7bc.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/e0f0e88e.1f3166a0.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/dc299e65.4c97dd89.js"><link rel="canonical" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/" data-rh="true"><link rel="alternate" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/" hreflang="en" data-rh="true"><link rel="alternate" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/" hreflang="x-default" data-rh="true"><meta property="og:url" content="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/" data-rh="true"><meta property="og:title" content="How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams | Blockchain Data API (V2)" data-rh="true"><meta name="description" content="Accurate, real-time wallet balance data is mission-critical for crypto businesses. Whether it&#39;s exchanges and custodians monitoring incoming deposits, DeFi protocols watching collateral positions, or analytics platforms tracking whale movements—speed matters. Just a few milliseconds can mean the difference between a successful liquidation or a costly missed opportunity." data-rh="true"><meta property="og:description" content="Accurate, real-time wallet balance data is mission-critical for crypto businesses. Whether it&#39;s exchanges and custodians monitoring incoming deposits, DeFi protocols watching collateral positions, or analytics platforms tracking whale movements—speed matters. Just a few milliseconds can mean the difference between a successful liquidation or a costly missed opportunity." data-rh="true"><script type="text/javascript" async="" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/f(1).txt"></script></head>
<body class="" data-theme="dark" data-rh="class,data-theme" style="overflow: visible;"><div id="hs-web-interactives-top-push-anchor" class="go3670563033"></div>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5GC69JH6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="https://docs.bitquery.io/"><div class="navbar__logo"><img src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/logoBitqueryWhite.png" alt="Bitquery.io" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a href="https://docs.bitquery.io/v1/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">V1 Docs</a><a aria-current="page" class="navbar__item navbar__link v2-highlight navbar__link--active" href="https://docs.bitquery.io/docs/intro/">V2 Docs</a><a href="https://bitquery.io/forms/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Book Demo</a><a href="https://dexrabbit.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DEX Dashboard</a><a href="https://lite.bitquery.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Free Investigation Tool</a><a href="https://bitquery.substack.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Newsletter</a></div><div class="navbar__items navbar__items--right"><a href="https://account.bitquery.io/user/api_v2/access_tokens" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Get your free Access Token</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP" type="button" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"><div class="aa-Autocomplete" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="autocomplete-0-label"><button type="button" class="aa-DetachedSearchButton"><div class="aa-DetachedSearchButtonIcon"><svg class="aa-SubmitIcon" viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M16.041 15.856c-0.034 0.026-0.067 0.055-0.099 0.087s-0.060 0.064-0.087 0.099c-1.258 1.213-2.969 1.958-4.855 1.958-1.933 0-3.682-0.782-4.95-2.050s-2.050-3.017-2.050-4.95 0.782-3.682 2.050-4.95 3.017-2.050 4.95-2.050 3.682 0.782 4.95 2.050 2.050 3.017 2.050 4.95c0 1.886-0.745 3.597-1.959 4.856zM21.707 20.293l-3.675-3.675c1.231-1.54 1.968-3.493 1.968-5.618 0-2.485-1.008-4.736-2.636-6.364s-3.879-2.636-6.364-2.636-4.736 1.008-6.364 2.636-2.636 3.879-2.636 6.364 1.008 4.736 2.636 6.364 3.879 2.636 6.364 2.636c2.125 0 4.078-0.737 5.618-1.968l3.675 3.675c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414z"></path></svg></div><div class="aa-DetachedSearchButtonPlaceholder">Search...</div><div class="aa-DetachedSearchButtonQuery"></div></button></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="https://docs.bitquery.io/docs/intro/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="https://docs.bitquery.io/docs/api-comparison/">API Comparison</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/start/">Start</a><button aria-label="Toggle the collapsible sidebar category &#39;Start&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/authorisation/">Authorisation</a><button aria-label="Toggle the collapsible sidebar category &#39;Authorisation&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/using-the-ide/">Using the IDE</a><button aria-label="Toggle the collapsible sidebar category &#39;Using the IDE&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/building-queries/">Building Queries</a><button aria-label="Toggle the collapsible sidebar category &#39;Building Queries&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/streaming/">Streaming</a><button aria-label="Toggle the collapsible sidebar category &#39;Streaming&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/understanding-cubes/">Understanding Cubes</a><button aria-label="Toggle the collapsible sidebar category &#39;Understanding Cubes&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/l1-chains/">L1 Chains</a><button aria-label="Toggle the collapsible sidebar category &#39;L1 Chains&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/l2-chains/">L2 Chains</a><button aria-label="Toggle the collapsible sidebar category &#39;L2 Chains&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="https://docs.bitquery.io/docs/category/how-to-guides/">How-To Guides</a><button aria-label="Toggle the collapsible sidebar category &#39;How-To Guides&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/usecases/MCP/">Building MCPs using Bitquery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/nft-applications/">NFT Applications</a><button aria-label="Toggle the collapsible sidebar category &#39;NFT Applications&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/tradingview-charting/">TradingView Charting</a><button aria-label="Toggle the collapsible sidebar category &#39;TradingView Charting&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="https://docs.bitquery.io/docs/category/building-applications-using-kafka/">Building Applications Using Kafka</a><button aria-label="Toggle the collapsible sidebar category &#39;Building Applications Using Kafka&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/">Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" tabindex="0" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/" aria-current="page">How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/blockchain-monitoring/">Blockchain Monitoring</a><button aria-label="Toggle the collapsible sidebar category &#39;Blockchain Monitoring&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/apps-and-dashboards/">Apps and Dashboards</a><button aria-label="Toggle the collapsible sidebar category &#39;Apps and Dashboards&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/bot-building/">Bot Building</a><button aria-label="Toggle the collapsible sidebar category &#39;Bot Building&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/data-in-cloud/">Data in Cloud</a><button aria-label="Toggle the collapsible sidebar category &#39;Data in Cloud&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/api-blog/">API Blog</a><button aria-label="Toggle the collapsible sidebar category &#39;API Blog&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="https://docs.bitquery.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.bitquery.io/docs/category/how-to-guides/"><span itemprop="name">How-To Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.bitquery.io/docs/category/building-applications-using-kafka/"><span itemprop="name">Building Applications Using Kafka</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams</h1><p>Accurate, real-time wallet balance data is mission-critical for crypto businesses. Whether it's exchanges and custodians monitoring incoming deposits, DeFi protocols watching collateral positions, or analytics platforms tracking whale movements—speed matters. Just a few milliseconds can mean the difference between a successful liquidation or a costly missed opportunity.
But tracking wallet balances on Solana is uniquely challenging. As a high-throughput blockchain, Solana processes thousands of transactions per second across millions of wallets. This makes traditional polling-based methods both inefficient and costly. Check this <a href="https://ide.bitquery.io/Transaction-in-1-hour_1" target="_blank" rel="noopener noreferrer">bitquery API</a> here, we are getting around 4000 TPS on Solana at the time of writing this article.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-polling-doesnt-scale-on-solana">Why polling doesn't scale on Solana:<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#why-polling-doesnt-scale-on-solana" class="hash-link" aria-label="Direct link to Why polling doesn&#39;t scale on Solana:" title="Direct link to Why polling doesn&#39;t scale on Solana:">​</a></h3><ul><li><p><strong>High volume</strong>: You risk missing updates due to polling intervals.</p></li><li><p><strong>Expensive</strong>: RPC calls scale poorly and become cost-prohibitive at millions of wallets.</p></li><li><p><strong>Laggy</strong>: Polling introduces delays between actual balance changes and detection.</p></li><li><p><strong>Unreliable</strong>: Under heavy load, RPC nodes can time out or fail.</p></li></ul><p>Traditionally, teams rely on Remote Procedure Call (RPC) polling to query wallet balances. But as your tracking scales, that model breaks down—wasting resources, increasing latency, and burning through RPC limits.
For a deeper dive into this problem space, check out our post on <a href="https://www.linkedin.com/pulse/scalable-balance-tracking-custodians-better-alternative-node-based-wiyuc" target="_blank" rel="noopener noreferrer">Scalable Balance Tracking for Custodians: A Better Alternative to Node-Based Approaches</a>.
In this article, we’ll walk through a practical implementation of scalable Solana wallet balance tracking using Bitquery’s Kafka Streams. We'll share code examples, design insights, and explain how Kafka helps you stream balance changes in real time—without hammering RPC nodes.
If you're new to Kafka, start with <a href="https://docs.bitquery.io/docs/streams/kafka-streaming-concepts/" target="_blank" rel="noopener noreferrer">Kafka Streaming Concepts</a> on Bitquery to get a basic understanding before diving in.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="who-needs-real-time-wallet-tracking">Who Needs Real-Time Wallet Tracking?<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#who-needs-real-time-wallet-tracking" class="hash-link" aria-label="Direct link to Who Needs Real-Time Wallet Tracking?" title="Direct link to Who Needs Real-Time Wallet Tracking?">​</a></h2><ul><li><p><strong>Exchanges</strong>: Detect deposits, monitor wallets, verify withdrawals</p></li><li><p><strong>DeFi</strong>: Track collateral, trigger liquidations, verify transactions</p></li><li><p><strong>Wallets</strong>: Show live balances, send alerts, log history</p></li><li><p><strong>Analytics</strong>: Spot whale moves, analyze trends, assess risks</p></li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The code presented here is a proof-of-concept intended to demonstrate core concepts. Production implementations for exchanges and financial institutions will require additional engineering as briefly outlined later in this article.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-is-balance-calculated-in-solana">How is Balance Calculated in Solana?<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#how-is-balance-calculated-in-solana" class="hash-link" aria-label="Direct link to How is Balance Calculated in Solana?" title="Direct link to How is Balance Calculated in Solana?">​</a></h2><p>Solana handles balances in a unique way that's important to understand for accurate tracking:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-postbalance">What is PostBalance?<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#what-is-postbalance" class="hash-link" aria-label="Direct link to What is PostBalance?" title="Direct link to What is PostBalance?">​</a></h3><p>In Solana transaction data, each account involvement includes two important balance values:</p><ul><li><strong>PreBalance</strong>: The account's balance before the transaction execution</li><li><strong>PostBalance</strong>: The account's balance after the transaction execution</li></ul><p>These are in the smallest token units (lamports for SOL, where 1 SOL = 1,000,000,000 lamports).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-we-use-postbalance">How We Use PostBalance<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#how-we-use-postbalance" class="hash-link" aria-label="Direct link to How We Use PostBalance" title="Direct link to How We Use PostBalance">​</a></h3><p>We use PostBalance because it's:</p><ol><li>The final account state after all operations</li><li>Blockchain-verified (more reliable than manual calculations)</li></ol><p>Our implementation:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token comment" style="color: rgb(98, 114, 164);"># Extract PostBalance from Kafka stream</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">post_balance </span><span class="token operator">=</span><span class="token plain"> balance_update</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">PostBalance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Convert to human-readable format</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">human_balance </span><span class="token operator">=</span><span class="token plain"> raw_balance </span><span class="token operator">/</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">**</span><span class="token plain"> decimals</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This ensures accurate balance tracking that matches wallet and explorer displays.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-start-guide">Quick Start Guide<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#quick-start-guide" class="hash-link" aria-label="Direct link to Quick Start Guide" title="Direct link to Quick Start Guide">​</a></h2><p><strong>GitHub Repository</strong>: <a href="https://github.com/akshat-cs/solana-wallet-tracker" target="_blank" rel="noopener noreferrer">https://github.com/akshat-cs/solana-wallet-tracker</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3><ol><li>Python</li><li>Access to Bitquery Kafka Streams (reach out to the Bitquery team on <a href="https://t.me/bloxy_info" target="_blank" rel="noopener noreferrer">Telegram</a> for credentials) is a completely free trial</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installation--setup">Installation &amp; Setup<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#installation--setup" class="hash-link" aria-label="Direct link to Installation &amp; Setup" title="Direct link to Installation &amp; Setup">​</a></h3><ol><li>Clone the repository:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">git clone https://github.com/akshat-cs/solana-wallet-tracker.git</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">cd solana-wallet-tracker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Install dependencies:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">pip install confluent-kafka protobuf base58 bitquery-pb2-kafka-package python-dotenv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Configure your credentials:</li></ol><p>Set these variables in a newly created .env file with the credentials you got from BQ support TG channel.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"># Kafka credentials</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">KAFKA_USERNAME = &lt;username&gt;</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">KAFKA_PASSWORD = &lt;password&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Run the wallet tracker:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">python wallet_balance_extractor.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-kafka-stream-data">Understanding the Kafka Stream Data<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#understanding-the-kafka-stream-data" class="hash-link" aria-label="Direct link to Understanding the Kafka Stream Data" title="Direct link to Understanding the Kafka Stream Data">​</a></h2><p>Before diving into the implementation, let's look at what the actual data from the Bitquery Kafka stream looks like. This will help you understand the rich information available to work with:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Full Message Details:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Header:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Slot: 333862663</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Hash:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    ParentSlot: 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Height: 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Timestamp: 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    ParentHash:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Transactions (repeated):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  [0]:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Index: 190</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Signature: 5SLabhmtAh8Bynx4Ee9aPUd8g7pWSBCMSvEoWJaKN9aGRzpxgUS83oqyvPYje4rHLBjH2h6tCttNFC6RmsMyLFMM</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Status:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Success: False</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        ErrorMessage: Error processing Instruction 2: custom program error: 0x1771</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Header:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Fee: 5625</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        FeePayer: CtxJeBMW3kGg3yG4MPacVxFNp76pieVrWXVe86VEcrfP</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        RecentBlockhash: EB3zVPGyV3ia6sDVxi2MHvu2B9KVGRuzUm2biggwBnbw</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Signer: CtxJeBMW3kGg3yG4MPacVxFNp76pieVrWXVe86VEcrfP</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    Transfers (repeated):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">      [0]:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        InstructionIndex: 4</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Amount: 1691000000</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Sender:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Address: AkG8tvC27HbMLunku4GLSEXbmmTwgX1nDEGoBjyHTJFJ</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            IsSigner: False</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            IsWritable: True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Token:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                Mint: So11111111111111111111111111111111111111112</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                Owner: CtxJeBMW3kGg3yG4MPacVxFNp76pieVrWXVe86VEcrfP</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                Decimals: 9</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                ProgramId: TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Receiver:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Address: DrVWWu8y13x5ZdSX7JTNH3XJJwptzh8xJ8nUphJZxY94</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            IsSigner: False</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            IsWritable: True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Token:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                Mint: So11111111111111111111111111111111111111112</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                Owner: 8wJymmvXgo7eK7kGgvwU3GaKaTN9nvZV2S36WC9gbrq4</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                Decimals: 9</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                ProgramId: TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Currency:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Name: Wrapped Solana</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Decimals: 9</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Uri:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Symbol: WSOL</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Native: False</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Wrapped: True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Fungible: True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            MintAddress: So11111111111111111111111111111111111111112</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        TokenBalanceUpdates (repeated):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">          [0]:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            PreBalance: 6012783083</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            PostBalance: 4321783083</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            AccountIndex: 5</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">          [1]:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            PreBalance: 1172836026228</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            PostBalance: 1174527026228</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            AccountIndex: 7</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    BalanceUpdates (repeated):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">      [0]:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        BalanceUpdate:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            PreBalance: 120566794</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            PostBalance: 120561169</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            AccountIndex: 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        Currency:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Name: Solana</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Decimals: 9</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Symbol: SOL</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Native: True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Wrapped: False</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            Fungible: True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            MintAddress: 11111111111111111111111111111111</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg viewBox="0 0 24 24" class="wordWrapButtonIcon_Bwma" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is just a small fraction of a single message - the actual messages can be several thousand lines long, containing detailed information about all token transfers, balance updates, and transaction details in a block.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="complete-code-walkthrough">Complete Code Walkthrough<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#complete-code-walkthrough" class="hash-link" aria-label="Direct link to Complete Code Walkthrough" title="Direct link to Complete Code Walkthrough">​</a></h2><p>Let's examine the entire implementation in detail:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="imports">Imports<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#imports" class="hash-link" aria-label="Direct link to Imports" title="Direct link to Imports">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">import uuid</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">import base58</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">import json</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">import os</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">from dotenv import load_dotenv</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">import time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">from datetime import datetime</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">from confluent_kafka import Consumer, KafkaError, KafkaException</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">from google.protobuf.message import DecodeError</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">from solana import token_block_message_pb2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-structure-indexedwallettracker">Class Structure: IndexedWalletTracker<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#class-structure-indexedwallettracker" class="hash-link" aria-label="Direct link to Class Structure: IndexedWalletTracker" title="Direct link to Class Structure: IndexedWalletTracker">​</a></h3><p>The IndexedWalletTracker class is the heart of our implementation. It manages the in-memory wallet index and processes Kafka messages to update balances.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialization">Initialization<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#initialization" class="hash-link" aria-label="Direct link to Initialization" title="Direct link to Initialization">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def __init__(self):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Create output directory</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.output_dir = "wallet_balances"</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if not os.path.exists(self.output_dir):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        os.makedirs(self.output_dir)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Timestamp for file naming</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # In-memory index of wallets: {address: {token: {balance, decimals, symbol, last_updated}}}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.wallet_index = {}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Token metadata cache: {token_mint: {symbol, decimals, name}}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.token_metadata = {}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Statistics tracking</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.stats = {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'messages_processed': 0,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'balance_updates_received': 0,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'unique_addresses': 0,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'unique_tokens': 0,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'start_time': time.time(),</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'last_export_time': time.time()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Export settings</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.export_interval = 30  # seconds between exports</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This initializes:</p><ul><li>A directory for storing exported data</li><li>The in-memory wallet index (nested dictionaries for fast lookups)</li><li>A token metadata cache (to avoid redundant processing)</li><li>Statistics tracking</li><li>Export interval settings</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="utility-functions">Utility Functions<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#utility-functions" class="hash-link" aria-label="Direct link to Utility Functions" title="Direct link to Utility Functions">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def convert_bytes(self, value):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Convert bytes to base58 string"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if isinstance(value, bytes):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        return base58.b58encode(value).decode()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return str(value)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This simple utility converts byte values (like addresses) to Solana's base58 format.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def calculate_human_balance(self, raw_balance, decimals):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Calculate human-readable balance based on token decimals"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if decimals &gt; 0:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        return raw_balance / (10 ** decimals)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return raw_balance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function converts raw token amounts (like 1000000000 lamports) to human-readable values (1 SOL) based on the token's decimal places.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="extracting-data-from-messages">Extracting Data from Messages<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#extracting-data-from-messages" class="hash-link" aria-label="Direct link to Extracting Data from Messages" title="Direct link to Extracting Data from Messages">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def extract_token_metadata(self, currency):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Extract token metadata from Currency object"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    token_mint = "UNKNOWN"</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    token_symbol = "UNKNOWN"</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    token_decimals = 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    token_name = "UNKNOWN"</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(currency, 'MintAddress') and currency.MintAddress:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        token_mint = self.convert_bytes(currency.MintAddress)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(currency, 'Symbol') and currency.Symbol:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        token_symbol = currency.Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(currency, 'Decimals'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        token_decimals = currency.Decimals</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(currency, 'Name') and currency.Name:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        token_name = currency.Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    else:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        token_name = token_symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Update token metadata cache</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if token_mint != "UNKNOWN":</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        self.token_metadata[token_mint] = {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            "symbol": token_symbol,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            "decimals": token_decimals,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            "name": token_name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Update unique tokens count</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        if len(self.token_metadata) &gt; self.stats['unique_tokens']:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            self.stats['unique_tokens'] = len(self.token_metadata)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        "mint": token_mint,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        "symbol": token_symbol,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        "decimals": token_decimals,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        "name": token_name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function extracts token metadata (mint address, symbol, decimals, name) from the Currency objects in the Kafka messages. It also updates the token metadata cache for future reference.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def extract_address(self, tx, account_index):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Extract address from transaction using account index"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    address = None</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Try Header.Accounts</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(tx, 'Header') and hasattr(tx.Header, 'Accounts'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        accounts = tx.Header.Accounts</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        if account_index &lt; len(accounts):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            account = accounts[account_index]</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if hasattr(account, 'Address'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                address = self.convert_bytes(account.Address)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Try Accounts directly</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if address is None and hasattr(tx, 'Accounts'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        accounts = tx.Accounts</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        if account_index &lt; len(accounts):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            account = accounts[account_index]</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if hasattr(account, 'Address'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                address = self.convert_bytes(account.Address)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return address</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function extracts a wallet address from a transaction given an account index. It tries multiple locations because the Solana message structure can vary.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="updating-wallet-balances">Updating Wallet Balances<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#updating-wallet-balances" class="hash-link" aria-label="Direct link to Updating Wallet Balances" title="Direct link to Updating Wallet Balances">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def update_wallet_balance(self, address, token_mint, token_info, raw_balance):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Update the wallet balance index with the latest balance"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if address == "UNKNOWN" or address is None:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        return False  # Skip unknown addresses</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Initialize address in index if needed</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if address not in self.wallet_index:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        self.wallet_index[address] = {}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Update unique addresses count</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        self.stats['unique_addresses'] = len(self.wallet_index)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Calculate human-readable balance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    human_balance = self.calculate_human_balance(raw_balance, token_info['decimals'])</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Update token balance for this address</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.wallet_index[address][token_mint] = {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'raw_balance': raw_balance,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'human_balance': human_balance,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'symbol': token_info['symbol'],</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'decimals': token_info['decimals'],</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        'last_updated': int(time.time())</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is the core function that updates our in-memory index with the latest wallet balance. It also calculates a human-readable balance value and tracks when the balance was last updated.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def process_balance_update(self, address, token_info, raw_balance):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Process a balance update and update the index"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if address and token_info['mint'] != "UNKNOWN":</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        success = self.update_wallet_balance(</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            address,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            token_info['mint'],</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            token_info,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            raw_balance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        )</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        if success:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            self.stats['balance_updates_received'] += 1</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            return True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return False</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is a wrapper around <code>update_wallet_balance</code> that also updates our statistics tracking.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exporting-balances">Exporting Balances<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#exporting-balances" class="hash-link" aria-label="Direct link to Exporting Balances" title="Direct link to Exporting Balances">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def export_balances(self, force=False):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Export current balances to file if interval has passed or forced"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    current_time = time.time()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    elapsed = current_time - self.stats['last_export_time']</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if force or elapsed &gt;= self.export_interval:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Create export file with timestamp</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        export_file = os.path.join(self.output_dir, f"balances_{self.timestamp}_latest.json")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Prepare export data</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        export_data = {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            'timestamp': datetime.now().isoformat(),</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            'stats': self.stats.copy(),</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            'wallets': self.wallet_index</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Add elapsed time and rate stats</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        total_elapsed = current_time - self.stats['start_time']</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        export_data['stats']['elapsed_seconds'] = total_elapsed</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        export_data['stats']['updates_per_second'] = (</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            self.stats['balance_updates_received'] / total_elapsed</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if total_elapsed &gt; 0 else 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        )</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Write to file</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        with open(export_file, 'w') as f:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            json.dump(export_data, f, indent=2)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Also create a CSV version for easy viewing</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        csv_file = os.path.join(self.output_dir, f"balances_{self.timestamp}_latest.csv")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        with open(csv_file, 'w') as f:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            # Write header</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            f.write("Address,Token,Symbol,HumanReadableBalance,RawBalance,Decimals,LastUpdated\n")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            # Write each wallet balance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            for address, tokens in self.wallet_index.items():</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                for token_mint, data in tokens.items():</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    f.write(f"{address},{token_mint},{data['symbol']}," +</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            f"{data['human_balance']},{data['raw_balance']}," +</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            f"{data['decimals']},{data['last_updated']}\n")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        # Update last export time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        self.stats['last_export_time'] = current_time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        print(f"Exported {len(self.wallet_index)} wallets with " +</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">              f"{self.stats['balance_updates_received']} balance records to {export_file}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        print(f"CSV export available at: {csv_file}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        return True</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    return False</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function exports our in-memory wallet balances to both JSON and CSV files. It only exports if the export interval has passed or if forced (e.g., at shutdown).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="processing-messages">Processing Messages<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#processing-messages" class="hash-link" aria-label="Direct link to Processing Messages" title="Direct link to Processing Messages">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def process_message(self, token_block):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    """Process a token block message"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.stats['messages_processed'] += 1</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Process balance updates at block level</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(token_block, 'BalanceUpdates'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        for update in token_block.BalanceUpdates:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if hasattr(update, 'BalanceUpdate') and hasattr(update, 'Currency'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                balance_update = update.BalanceUpdate</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                currency = update.Currency</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                # Extract token metadata</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                token_info = self.extract_token_metadata(currency)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                # Extract balance and account</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                if hasattr(balance_update, 'PostBalance') and hasattr(balance_update, 'AccountIndex'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    post_balance = balance_update.PostBalance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    account_index = balance_update.AccountIndex</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    # For block level updates, we often can't resolve the address</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    # But we can try to look in transactions</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    address = None</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(token_block, 'Transactions'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        for tx in token_block.Transactions:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            addr = self.extract_address(tx, account_index)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            if addr:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                address = addr</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                break</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if address:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        self.process_balance_update(address, token_info, post_balance)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is the first part of the <code>process_message</code> method, which handles block-level balance updates. The method is quite long, as it needs to handle multiple data sources within each message.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Process transactions</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if hasattr(token_block, 'Transactions'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        for tx in token_block.Transactions:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            # Process transfers - these usually have the best address information</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if hasattr(tx, 'Transfers'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                for transfer in tx.Transfers:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    # Extract token metadata</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    token_info = {"mint": "UNKNOWN", "symbol": "UNKNOWN", "decimals": 0, "name": "UNKNOWN"}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(transfer, 'Currency'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        token_info = self.extract_token_metadata(transfer.Currency)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    # Get sender and receiver addresses</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    sender_address = None</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(transfer, 'Sender') and hasattr(transfer.Sender, 'Address'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        sender_address = self.convert_bytes(transfer.Sender.Address)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    receiver_address = None</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(transfer, 'Receiver') and hasattr(transfer.Receiver, 'Address'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        receiver_address = self.convert_bytes(transfer.Receiver.Address)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    # Process balance updates in instruction</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(transfer, 'Instruction') and hasattr(transfer.Instruction, 'TokenBalanceUpdates'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        for balance_update in transfer.Instruction.TokenBalanceUpdates:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            if hasattr(balance_update, 'PostBalance') and hasattr(balance_update, 'AccountIndex'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                post_balance = balance_update.PostBalance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                account_index = balance_update.AccountIndex</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                # Determine address based on account index</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                address = None</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                if account_index == 0 and sender_address:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                    address = sender_address</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                elif account_index == 2 and receiver_address:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                    address = receiver_address</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                if address:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                    self.process_balance_update(address, token_info, post_balance)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg viewBox="0 0 24 24" class="wordWrapButtonIcon_Bwma" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The next segment processes transfers, which provide the most accurate and direct information about wallet balance changes. It extracts the token metadata, sender and receiver addresses, and processes the balance updates for each.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           # Process transaction-level balance updates</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if hasattr(tx, 'BalanceUpdates'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                for update in tx.BalanceUpdates:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(update, 'BalanceUpdate') and hasattr(update, 'Currency'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        balance_update = update.BalanceUpdate</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        currency = update.Currency</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        # Extract token metadata</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        token_info = self.extract_token_metadata(currency)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        # Extract balance and account</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        if hasattr(balance_update, 'PostBalance') and hasattr(balance_update, 'AccountIndex'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            post_balance = balance_update.PostBalance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            account_index = balance_update.AccountIndex</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            # Get address from transaction</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            address = self.extract_address(tx, account_index)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            if address:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                self.process_balance_update(address, token_info, post_balance)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg viewBox="0 0 24 24" class="wordWrapButtonIcon_Bwma" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This segment processes transaction-level balance updates, which provide additional balance information that might not be captured in transfers.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           # Process token balance updates</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            if hasattr(tx, 'TokenBalanceUpdates'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                for update in tx.TokenBalanceUpdates:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                    if hasattr(update, 'PostBalance') and hasattr(update, 'AccountIndex'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        post_balance = update.PostBalance</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        account_index = update.AccountIndex</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        # Get address from transaction</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        address = self.extract_address(tx, account_index)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        # Get token info from account</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        token_info = {"mint": "UNKNOWN", "symbol": "UNKNOWN", "decimals": 0, "name": "UNKNOWN"}</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        if hasattr(tx, 'Accounts') or (hasattr(tx, 'Header') and hasattr(tx.Header, 'Accounts')):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            accounts = tx.Accounts if hasattr(tx, 'Accounts') else tx.Header.Accounts</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            if account_index &lt; len(accounts):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                account = accounts[account_index]</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                if hasattr(account, 'Token'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                    token = account.Token</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                    if hasattr(token, 'Mint'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                        token_info["mint"] = self.convert_bytes(token.Mint)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                    if hasattr(token, 'Decimals'):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                                        token_info["decimals"] = token.Decimals</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        # Use token metadata from cache if available</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        if token_info["mint"] != "UNKNOWN" and token_info["mint"] in self.token_metadata:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            cached_data = self.token_metadata[token_info["mint"]]</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            token_info["symbol"] = cached_data["symbol"]</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            token_info["name"] = cached_data["name"]</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                        if address:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                            self.process_balance_update(address, token_info, post_balance)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg viewBox="0 0 24 24" class="wordWrapButtonIcon_Bwma" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, the method processes token balance updates, which provide yet another source of balance information. This multi-layered approach ensures we capture all possible balance changes.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Export balances if it's time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    self.export_balances()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    # Periodically print stats</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    if self.stats['messages_processed'] % 10 == 0:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        self.print_stats()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After processing all the balance updates, the method checks if it's time to export the balances and prints statistics periodically.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="statistics-reporting">Statistics Reporting<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#statistics-reporting" class="hash-link" aria-label="Direct link to Statistics Reporting" title="Direct link to Statistics Reporting">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   def print_stats(self):</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       """Print tracker statistics"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       elapsed = time.time() - self.stats['start_time']</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       updates_per_sec = (</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           self.stats['balance_updates_received'] / elapsed</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           if elapsed &gt; 0 else 0</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       )</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print(f"\n--- Wallet Balance Tracker Stats ---")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print(f"Runtime: {elapsed:.2f} seconds")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print(f"Messages processed: {self.stats['messages_processed']}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print(f"Balance updates received: {self.stats['balance_updates_received']} ({updates_per_sec:.2f}/sec)")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print(f"Unique addresses tracked: {self.stats['unique_addresses']}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print(f"Unique tokens tracked: {self.stats['unique_tokens']}")</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg viewBox="0 0 24 24" class="wordWrapButtonIcon_Bwma" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This method prints statistics about the tracker's performance, including runtime, messages processed, balance updates received, and the number of unique addresses and tokens tracked.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="main-consumer-function">Main Consumer Function<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#main-consumer-function" class="hash-link" aria-label="Direct link to Main Consumer Function" title="Direct link to Main Consumer Function">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">def run_consumer():</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   """Run the Kafka consumer with the indexed wallet tracker"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Load environment variables from .env file</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   load_dotenv()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Get credentials from environment variables</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   kafka_username = os.getenv("KAFKA_USERNAME")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   kafka_password = os.getenv("KAFKA_PASSWORD")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Kafka configuration</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   group_id_suffix = uuid.uuid4().hex</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   conf = {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'bootstrap.servers': 'rpk0.bitquery.io:9092,rpk1.bitquery.io:9092,rpk2.bitquery.io:9092',</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'group.id': f'{kafka_username}-group-{group_id_suffix}',</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'session.timeout.ms': 30000,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'security.protocol': 'SASL_PLAINTEXT',</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'ssl.endpoint.identification.algorithm': 'none',</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'sasl.mechanisms': 'SCRAM-SHA-512',</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'sasl.username': kafka_username,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'sasl.password': kafka_password,</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       'auto.offset.reset': 'latest',</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Initialize consumer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   consumer = Consumer(conf)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   topic = 'solana.tokens.proto'</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   consumer.subscribe([topic])</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   # Initialize wallet tracker</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   tracker = IndexedWalletTracker()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   print(f"Starting indexed wallet balance tracker on topic: {topic}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   print("Press Ctrl+C to stop...")</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function initializes the Kafka consumer with the appropriate configuration and sets up the wallet tracker.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  try:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       while True:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           msg = consumer.poll(timeout=1.0)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           if msg is None:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               continue</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           if msg.error():</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               if msg.error().code() == KafkaError._PARTITION_EOF:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                   continue</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               else:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                   raise KafkaException(msg.error())</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           try:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               # Parse the message</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               buffer = msg.value()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               token_block = token_block_message_pb2.TokenBlockMessage()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               token_block.ParseFromString(buffer)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               # Process the message</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               tracker.process_message(token_block)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           except DecodeError as err:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               print(f"Protobuf decoding error: {err}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">           except Exception as err:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               print(f"Error processing message: {err}")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               import traceback</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">               traceback.print_exc()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The main processing loop polls for messages from Kafka, parses them using the protobuf definition, and passes them to the tracker for processing. It includes error handling to catch and report any issues.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   except KeyboardInterrupt:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">print("\nStopping wallet balance tracker...")</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">   finally:</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       # Export final balances</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       tracker.export_balances(force=True)</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       consumer.close()</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">       print("Consumer closed.")</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The function concludes with cleanup code that exports the final balances and closes the consumer when the program is stopped.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-flow-through-the-system">Data Flow Through the System<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#data-flow-through-the-system" class="hash-link" aria-label="Direct link to Data Flow Through the System" title="Direct link to Data Flow Through the System">​</a></h2><p>To understand how data flows through this system:</p><ol><li>Kafka Consumer retrieves messages from Bitquery's Solana token stream</li><li>Each message is parsed into a protobuf TokenBlockMessage object</li><li>The process_message method extracts:<ul><li>Block-level balance updates</li><li>Transfers and their associated balance updates</li><li>Transaction-level balance updates</li><li>Token balance updates</li></ul></li><li>For each balance update, the system:<ul><li>Extracts token metadata (mint, symbol, decimals)</li><li>Finds the associated wallet address</li><li>Updates the in-memory wallet index with the latest balance</li></ul></li><li>Periodically, the system exports the in-memory balances to JSON and CSV files</li><li>Statistics are printed to the console to monitor performance</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scaling-for-production-use">Scaling for Production Use<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#scaling-for-production-use" class="hash-link" aria-label="Direct link to Scaling for Production Use" title="Direct link to Scaling for Production Use">​</a></h2><p>While this proof-of-concept demonstrates the core concepts, a production implementation would require several additional components:</p><ul><li><strong>Database integration</strong>: Replace file exports with a proper database system</li><li><strong>Distributed processing</strong>: Run multiple consumer instances with the same group ID</li><li><strong>Caching strategy</strong>: Implement memory management for less active wallets</li><li><strong>Error recovery</strong>: Add robust error handling and consumer position checkpointing</li><li><strong>Monitoring and alerting</strong>: Add systems to detect processing lags or failures</li><li><strong>API layer</strong>: Create endpoints for querying balance data</li></ul><p>For exchanges, custodial services, and other financial institutions, additional considerations around security, high availability, and compliance would also be necessary.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion-beyond-rpc-polling">Conclusion: Beyond RPC Polling<a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#conclusion-beyond-rpc-polling" class="hash-link" aria-label="Direct link to Conclusion: Beyond RPC Polling" title="Direct link to Conclusion: Beyond RPC Polling">​</a></h2><p>Traditional RPC-based balance monitoring simply can't keep up with the demands of modern blockchain applications. By leveraging Bitquery's Kafka Streams, you can:</p><ul><li>Reduce infrastructure costs by up to 90% compared to RPC polling</li><li>Improve detection latency from seconds to milliseconds</li><li>Scale to millions of wallets without performance degradation</li><li>Achieve 100% accuracy with no missed transactions</li></ul><p>Ready to explore how Bitquery's Kafka Streams could transform your wallet monitoring capabilities? Clone the <a href="https://github.com/bitquery/solana-wallet-tracker" target="_blank" rel="noopener noreferrer">repository</a> for a starting point and reach out to the Bitquery team on <a href="https://t.me/bloxy_info" target="_blank" rel="noopener noreferrer">Telegram</a> to discuss your specific requirements and get access to the streams.</p><hr><p><em>This article provides a technical overview and implementation guidance. The code presented is a proof-of-concept that demonstrates core principles but would require additional engineering for production use. Always conduct thorough testing and security reviews before deploying systems handling financial data.</em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bitquery/streaming-data-platform-docs/tree/main/docs/usecases/track-millions-of-solana-wallets.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets</div></a><a class="pagination-nav__link pagination-nav__link--next" href="https://docs.bitquery.io/docs/category/blockchain-monitoring/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Blockchain Monitoring</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#why-polling-doesnt-scale-on-solana" class="table-of-contents__link toc-highlight">Why polling doesn't scale on Solana:</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#who-needs-real-time-wallet-tracking" class="table-of-contents__link toc-highlight">Who Needs Real-Time Wallet Tracking?</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#how-is-balance-calculated-in-solana" class="table-of-contents__link toc-highlight">How is Balance Calculated in Solana?</a><ul><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#what-is-postbalance" class="table-of-contents__link toc-highlight">What is PostBalance?</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#how-we-use-postbalance" class="table-of-contents__link toc-highlight">How We Use PostBalance</a></li></ul></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#quick-start-guide" class="table-of-contents__link toc-highlight">Quick Start Guide</a><ul><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#installation--setup" class="table-of-contents__link toc-highlight">Installation &amp; Setup</a></li></ul></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#understanding-the-kafka-stream-data" class="table-of-contents__link toc-highlight">Understanding the Kafka Stream Data</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#complete-code-walkthrough" class="table-of-contents__link toc-highlight">Complete Code Walkthrough</a><ul><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#imports" class="table-of-contents__link toc-highlight">Imports</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#class-structure-indexedwallettracker" class="table-of-contents__link toc-highlight">Class Structure: IndexedWalletTracker</a></li></ul></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#data-flow-through-the-system" class="table-of-contents__link toc-highlight">Data Flow Through the System</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#scaling-for-production-use" class="table-of-contents__link toc-highlight">Scaling for Production Use</a></li><li><a href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/#conclusion-beyond-rpc-polling" class="table-of-contents__link toc-highlight">Conclusion: Beyond RPC Polling</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://bitquery.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://docs.bitquery.io/v1/" target="_blank" rel="noopener noreferrer" class="footer__link-item">V1 Docs</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.bitquery.io/docs/intro/">V2 Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/Bloxy_info" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Bitquery_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://community.bitquery.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/bitquery" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://bitquery.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Bitquery, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/runtime~main.94f1a4d2.js.Без названия"></script>
<script src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/main.19751415.js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>


<div class="go2933276541 go2369186930" id="hs-web-interactives-top-anchor"><div id="hs-interactives-modal-overlay" class="go1632949049"></div></div>
<div class="go2933276541 go1348078617" id="hs-web-interactives-bottom-anchor"></div>
<div id="hs-web-interactives-floating-container">
  <div id="hs-web-interactives-floating-top-left-anchor" class="go2417249464 go613305155">
  </div>
  <div id="hs-web-interactives-floating-top-right-anchor" class="go2417249464 go471583506">
  </div>
  <div id="hs-web-interactives-floating-bottom-left-anchor" class="go2417249464 go3921366393">
  </div>
  <div id="hs-web-interactives-floating-bottom-right-anchor" class="go2417249464 go3967842156">
  </div>
</div>
<style>
#chatbase-bubble-button,
#chatbase-bubble-button * {
margin: 0;
padding: 0;
box-sizing: border-box;
}
html.__cb_widget_active,
html.__cb_widget_active body {
position: fixed !important;
top: 0;
left: 0;
overscroll-behavior: none;
width: 0 !important;
height: 0 !important;
margin: 0 !important;
overflow: hidden !important;
overflow-y: hidden !important;
overflow-x: hidden !important;
transform: none !important;
}

#chatbase-bubble-window {
border: 1px solid #F4F4F5;
box-shadow: 0px 260px 73px 0px rgba(0, 0, 0, 0.00), 0px 166px 67px 0px rgba(0, 0, 0, 0.01), 0px 94px 56px 0px rgba(0, 0, 0, 0.02), 0px 42px 42px 0px rgba(0, 0, 0, 0.03), 0px 10px 23px 0px rgba(0, 0, 0, 0.04);
backdrop-filter: blur(4px);
-webkit-backdrop-filter: blur(4px);
}

</style><div id="chatbase-message-bubbles" style="position: fixed; bottom: 85px; border-radius: 10px; font-family: sans-serif; font-size: 16px; z-index: 2147483644; cursor: pointer; flex-direction: column; gap: 50px; max-width: 70vw; display: none; right: 1rem; left: unset;"><div style="position: absolute; top: -7px; right: -7px; font-weight: bold; display: none; justify-content: center; align-items: center; z-index: 2147483643; width: 22px; height: 22px; border-radius: 50%; text-align: center; font-size: 12px; cursor: pointer; background-color: rgb(224, 224, 224); color: black; box-shadow: rgba(150, 150, 150, 0.15) 0px 6px 24px 0px, rgba(150, 150, 150, 0.15) 0px 0px 0px 1px;">✕</div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">Which Query or API can I help you build? (Please mention the blockchain name and be precise)</div></div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">For additional questions, please contact us on Telegram (https://t.me/Bloxy_info)</div></div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">Note that this chat only answer questions about API v2 and API EAP. For questions on API v1 please select appropriate API endpoint from the list in IDE.</div></div></div><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752165324304" height="0" width="0" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/11376996312.html" style="display: none; visibility: hidden;"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/saved_resource.html"></iframe><button type="button" id="chatbase-bubble-button" aria-label="chat-button" style="position: fixed; border: 0px; bottom: 1rem; right: 1rem; width: 55px; height: 55px; border-radius: 27.5px; background-color: rgb(144, 19, 254); box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px 0px; cursor: pointer; z-index: 2147483645; transition: 0.2s ease-in-out; left: unset; transform: scale(1);"><div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; z-index: 2147483646;"><svg width="55" height="55" viewBox="0 0 1120 1120" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M252 434C252 372.144 302.144 322 364 322H770C831.856 322 882 372.144 882 434V614.459L804.595 585.816C802.551 585.06 800.94 583.449 800.184 581.405L763.003 480.924C760.597 474.424 751.403 474.424 748.997 480.924L711.816 581.405C711.06 583.449 709.449 585.06 707.405 585.816L606.924 622.997C600.424 625.403 600.424 634.597 606.924 637.003L707.405 674.184C709.449 674.94 711.06 676.551 711.816 678.595L740.459 756H629.927C629.648 756.476 629.337 756.945 628.993 757.404L578.197 825.082C572.597 832.543 561.403 832.543 555.803 825.082L505.007 757.404C504.663 756.945 504.352 756.476 504.073 756H364C302.144 756 252 705.856 252 644V434ZM633.501 471.462C632.299 468.212 627.701 468.212 626.499 471.462L619.252 491.046C618.874 492.068 618.068 492.874 617.046 493.252L597.462 500.499C594.212 501.701 594.212 506.299 597.462 507.501L617.046 514.748C618.068 515.126 618.874 515.932 619.252 516.954L626.499 536.538C627.701 539.788 632.299 539.788 633.501 536.538L640.748 516.954C641.126 515.932 641.932 515.126 642.954 514.748L662.538 507.501C665.788 506.299 665.788 501.701 662.538 500.499L642.954 493.252C641.932 492.874 641.126 492.068 640.748 491.046L633.501 471.462Z" fill="white"></path>
<path d="M771.545 755.99C832.175 755.17 881.17 706.175 881.99 645.545L804.595 674.184C802.551 674.94 800.94 676.551 800.184 678.595L771.545 755.99Z" fill="white"></path>
</svg>            
</div></button><div id="chatbase-bubble-window" style="border: none; position: fixed; flex-direction: column; justify-content: space-between; bottom: 85px; right: 1rem; width: 406px; height: 85dvh; max-height: 824px; border-radius: 1.25rem; display: none; z-index: 2147483646; overflow: hidden; background-color: white; left: unset;"><div style="display: none; justify-content: center; height: 100%; align-items: center;"><svg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" stroke="black" style="width:30px;height:30px;">
  <g>
      <rect x="11" y="1" width="2" height="5" opacity=".14"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(30 12 12)" opacity=".29"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(60 12 12)" opacity=".43"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(90 12 12)" opacity=".57"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(120 12 12)" opacity=".71"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(150 12 12)" opacity=".86"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(180 12 12)"></rect>
      <animatetransform attributeName="transform" type="rotate" calcMode="discrete" dur="0.75s" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12" repeatCount="indefinite"></animatetransform>
  </g>
</svg></div><iframe title="Chatbot" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/Vz0cwoEYRJW6n5B2JeSeu.html" style="height: 100%; width: 100%; border: none; display: block;"></iframe></div>
<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752165346052" height="0" width="0" src="./How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams _ Blockchain Data API (V2)_files/11376996312(1).html" style="display: none; visibility: hidden;"></iframe>
</body></html>