<!DOCTYPE html>
<!-- saved from url=(0069)https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/ -->
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-subscriptions/backfilling-subscription" data-has-hydrated="true" data-theme="dark" data-rh="lang,dir,class,data-has-hydrated"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="Docusaurus v2.4.3">
<title>How to Backfill Data After a WebSocket Disconnection in Python | Blockchain Data API (V2)</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.bitquery.io/img/heroImage4.png"><meta data-rh="true" name="twitter:image" content="https://docs.bitquery.io/img/heroImage4.png"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><link data-rh="true" rel="icon" href="https://docs.bitquery.io/img/favicon.ico"><link rel="alternate" type="application/rss+xml" href="https://docs.bitquery.io/blog/rss.xml" title="Blockchain Data API (V2) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="https://docs.bitquery.io/blog/atom.xml" title="Blockchain Data API (V2) Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com/">
<link rel="preconnect" href="https://www.googletagmanager.com/">
<script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/js"></script><script type="text/javascript" id="www-widgetapi-script" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/www-widgetapi.js.Без названия" async=""></script><script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/fb.js.Без названия" type="text/javascript" id="hs-ads-pixel-6314272" data-ads-portal-id="6314272" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/web-interactives-embed.js.Без названия" type="text/javascript" id="hubspot-web-interactives-loader" crossorigin="anonymous" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/leadflows.js.Без названия" type="text/javascript" id="LeadFlows-6314272" crossorigin="anonymous" data-leadin-portal-id="6314272" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/banner.js.Без названия" type="text/javascript" id="cookieBanner-6314272" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272.js.Без названия" type="text/javascript" id="hs-analytics"></script><script async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/gtm.js.Без названия"></script><script async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/js(1)"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZWB80TDH9J",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com/">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-5GC69JH6",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>




<script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/embed.min.js.Без названия" async="" id="Vz0cwoEYRJW6n5B2JeSeu" domain="www.chatbase.co"></script>
<script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/chatbase-open.js.Без названия" defer="defer"></script><link rel="stylesheet" href="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/styles.2db95959.css">
<link rel="preload" href="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/runtime~main.402cce67.js.Без названия" as="script">
<link rel="preload" href="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/main.b44c1ae9.js.Без названия" as="script">
<meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/3d6d56b6.86cc964c.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/0e384e19.1ec5afa4.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/49bb8dc3.e1fca388.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1b6f41eb.954b8aba.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/54eaf17b.63331e2d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/6d84b776.e0364f6a.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9cd21d7b.974c97ff.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/e71bdf3f.8c77d59f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/550d9d1c.a39f7662.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4ad85961.66bc2132.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/e94080e1.5148b644.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/d505773d.5aa5f4b1.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4c842849.c3f0a286.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/da57af4e.999dd7e9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/41fa0d41.e7b7df6f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/122c5c07.e5554a26.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/c4f5d8e4.e98f0852.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/ad776868.2e6af93e.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4144071c.ce143a28.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4bfd9c68.19ceb9b4.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/aaf5123e.a0d8f7cf.js"><script type="text/javascript" charset="utf8" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/iframe_api"></script><style id="_goober"> .go2933276541{position:fixed;display:block;width:100%;height:0px;margin:0px;padding:0px;overflow:visible;transform-style:preserve-3d;background:transparent;backface-visibility:hidden;pointer-events:none;left:0px;z-index:9998;}.go2369186930{top:0px;z-index:9999;height:100%;width:100%;}.go1348078617{bottom:0px;}.go2417249464{position:fixed;z-index:9989;}.go3921366393{left:0;bottom:0;}.go3967842156{right:0;bottom:0;}.go613305155{left:0;top:0;}.go471583506{right:0;top:0;}.go3670563033{position:relative;overflow:hidden;display:none;}.go1041095097{display:block;}.go1632949049{position:absolute;pointer-events:none;width:101vw;height:101vh;background:rgba(0,0,0,0.7);opacity:0;z-index:-1;}.go2512015367{z-index:99998;opacity:0.8;visibility:visible;pointer-events:all;cursor:pointer;}.go1432718904{overflow:hidden;}.go812842568{display:block !important;position:static !important;box-sizing:border-box !important;background:transparent !important;border:none;min-height:0px !important;max-height:none !important;margin:0px;padding:0px !important;height:100% !important;width:1px !important;max-width:100% !important;min-width:100% !important;}.go4194603687{z-index:99999;visibility:hidden;position:absolute;inset:50vh auto auto 50%;transform:translate(-50%,-50%);left:50%;top:150%;pointer-events:none;max-height:95%;max-width:95%;}.go4258295619{pointer-events:auto !important;visibility:visible;top:50%;transition:top 0.75s linear(0,0.006,0.023 2.2%,0.096 4.8%,0.532 15.4%,0.72 21%,0.793,0.853 26.7%,0.902,0.941,0.968 36.2%,0.987 39.7%,1 43.7%,1.007 48.3%,1.009 55.3%,1.002 78.2%,1 );}.go456419034{transition:opacity 0.3s ease-in;}.go3128134379{pointer-events:auto !important;visibility:visible !important;max-height:95vh !important;transition:max-height 1s ease-in;}.go494047706{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;}.go2481764524{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;bottom:0px;}.go2685733372{visibility:hidden;}.go2985984737{visibility:visible !important;}.go3281949485{pointer-events:auto !important;visibility:visible !important;max-height:95vh !important;transform:none !important;}.go3508454897{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;transition:transform 1s linear(0,0.006,0.022 2.3%,0.091 5.1%,0.18 7.6%,0.508 16.3%,0.607,0.691,0.762,0.822 28.4%,0.872,0.912 35.1%,0.944 38.9%,0.968 43%,0.985 47.6%,0.996 53.1%,1.001 58.4%,1.003 65.1%,1 );}.go988075951{z-index:9999;position:fixed;left:10px;top:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go2699082514{z-index:9999;position:fixed;right:10px;top:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go1595992025{z-index:9999;position:fixed;left:10px;bottom:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go1222083472{z-index:9999;position:fixed;right:10px;bottom:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go722322694{transition:none !important;}.go26732895{cursor:pointer;}.go2083580917{display:flex;justify-content:center;align-items:center;}</style><script async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/js(2)"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f.txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/32256d82.c027d3a0.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(1).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(2).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/05e0a484.c76e4667.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(3).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/a468e46b.901c42bb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4bd2478d.bd11c6a0.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/137b7510.8656ae2d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/e0f0e88e.1f3166a0.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/dc299e65.4c97dd89.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(4).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/35c96c78.9335d7a4.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/2ca601ca.36cb8a24.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17a0f004.24777145.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/54decfb1.6dfaa106.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/e8a37582.af2c0e72.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/71855794.5fe338e9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1c6abff2.759905b1.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/ae3638ae.5257ff2b.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(5).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/d18e5b4c.107bb411.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/c8b4884f.3c3cf446.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/faebf1bc.92652c11.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/015aaed0.a43e3db3.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(6).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(7).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(8).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/e10becef.5c7982f7.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(9).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1478c431.7994062c.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/c1237e75.67ca54b8.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(10).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(11).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(12).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(13).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(14).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(15).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(16).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/7a859be3.535f8983.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/c2df117d.fee69f2f.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(17).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4c7042a8.9d28759c.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/12c2ee2f.d02e2b3b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/6629e694.98101625.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/8a9ae806.28c7d1ea.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/d96dc247.8f2f8e1a.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4e28f802.24c93753.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/ae8f25d1.0e1480d3.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(18).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/85b7dde7.f5c45c85.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(19).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/743de269.a33a519e.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/d953c349.1d7a85e0.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(20).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(21).txt"></script><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(22).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1ed52206.b1d76b75.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(23).txt"></script><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.22d2c772.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/ae9538c8.31f237de.js"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(24).txt"></script><link rel="canonical" href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/" data-rh="true"><link rel="alternate" href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/" hreflang="en" data-rh="true"><link rel="alternate" href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/" hreflang="x-default" data-rh="true"><meta property="og:url" content="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/" data-rh="true"><meta property="og:title" content="How to Backfill Data After a WebSocket Disconnection in Python | Blockchain Data API (V2)" data-rh="true"><meta name="description" content="In this section, we&#39;ll discuss potential approaches to backfill data when stream disconnects. We will write code to receive live data, handles potential errors and disconnections, backfills any missing data during downtime, and ensures a graceful closure of connections." data-rh="true"><meta property="og:description" content="In this section, we&#39;ll discuss potential approaches to backfill data when stream disconnects. We will write code to receive live data, handles potential errors and disconnections, backfills any missing data during downtime, and ensures a graceful closure of connections." data-rh="true"><script type="text/javascript" async="" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/f(25).txt"></script></head>
<body class="" data-theme="dark" data-rh="class,data-theme" style="overflow: visible;"><div id="hs-web-interactives-top-push-anchor" class="go3670563033"></div>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5GC69JH6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="https://docs.bitquery.io/"><div class="navbar__logo"><img src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/logoBitqueryWhite.png" alt="Bitquery.io" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a href="https://docs.bitquery.io/v1/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">V1 Docs</a><a aria-current="page" class="navbar__item navbar__link v2-highlight navbar__link--active" href="https://docs.bitquery.io/docs/intro/">V2 Docs</a><a href="https://bitquery.io/forms/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Book Demo</a><a href="https://dexrabbit.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DEX Dashboard</a><a href="https://lite.bitquery.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Free Investigation Tool</a><a href="https://bitquery.substack.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Newsletter</a></div><div class="navbar__items navbar__items--right"><a href="https://account.bitquery.io/user/api_v2/access_tokens" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Get your free Access Token</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP" type="button" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"><div class="aa-Autocomplete" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="autocomplete-0-label"><button type="button" class="aa-DetachedSearchButton"><div class="aa-DetachedSearchButtonIcon"><svg class="aa-SubmitIcon" viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M16.041 15.856c-0.034 0.026-0.067 0.055-0.099 0.087s-0.060 0.064-0.087 0.099c-1.258 1.213-2.969 1.958-4.855 1.958-1.933 0-3.682-0.782-4.95-2.050s-2.050-3.017-2.050-4.95 0.782-3.682 2.050-4.95 3.017-2.050 4.95-2.050 3.682 0.782 4.95 2.050 2.050 3.017 2.050 4.95c0 1.886-0.745 3.597-1.959 4.856zM21.707 20.293l-3.675-3.675c1.231-1.54 1.968-3.493 1.968-5.618 0-2.485-1.008-4.736-2.636-6.364s-3.879-2.636-6.364-2.636-4.736 1.008-6.364 2.636-2.636 3.879-2.636 6.364 1.008 4.736 2.636 6.364 3.879 2.636 6.364 2.636c2.125 0 4.078-0.737 5.618-1.968l3.675 3.675c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414z"></path></svg></div><div class="aa-DetachedSearchButtonPlaceholder">Search...</div><div class="aa-DetachedSearchButtonQuery"></div></button></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="https://docs.bitquery.io/docs/intro/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="https://docs.bitquery.io/docs/api-comparison/">API Comparison</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/start/">Start</a><button aria-label="Toggle the collapsible sidebar category &#39;Start&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/authorisation/">Authorisation</a><button aria-label="Toggle the collapsible sidebar category &#39;Authorisation&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/using-the-ide/">Using the IDE</a><button aria-label="Toggle the collapsible sidebar category &#39;Using the IDE&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="https://docs.bitquery.io/docs/category/building-queries/">Building Queries</a><button aria-label="Toggle the collapsible sidebar category &#39;Building Queries&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/capabilities/">Capabilities</a><button aria-label="Toggle the collapsible sidebar category &#39;Capabilities&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="https://docs.bitquery.io/docs/category/dataset/">Dataset</a><button aria-label="Toggle the collapsible sidebar category &#39;Dataset&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/archive/">Archive Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/combined/">Combined Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/database/">Database Selection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/EAP/">Early Access Program</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/network/">Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/options/">Options</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/realtime/">Realtime Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/dataset/select-blocks/">Blockchain Reorg Tree</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="https://docs.bitquery.io/docs/category/metrics/">Metrics</a><button aria-label="Toggle the collapsible sidebar category &#39;Metrics&#39;" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list" style="display: block; overflow: visible; height: auto; will-change: height; transition: height 334ms ease-in-out;"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/alias/">Aliases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/count/">Count</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/distinct/">Count Distinct</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/if/">Conditional Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/">Using Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/priceAsymmetry/">Price Asymmetry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/selectWhere/">Select By Metric</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/statistics/">Statistics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/sum/">Sum</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/uniq/">Uniq</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/graphql/metrics/quantile/">Quantile</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="https://docs.bitquery.io/docs/category/streaming/">Streaming</a><button aria-label="Toggle the collapsible sidebar category &#39;Streaming&#39;" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list" style="display: block; overflow: visible; height: auto; will-change: height; transition: height 220ms ease-in-out;"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="https://docs.bitquery.io/docs/category/streaming-via-subscriptions/">Streaming via Subscriptions</a><button aria-label="Toggle the collapsible sidebar category &#39;Streaming via Subscriptions&#39;" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list" style="display: block; overflow: visible; height: auto; will-change: height; transition: height 357ms ease-in-out;"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/subscription/">What is a Subscription?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/trigger/">What is a Trigger?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/websockets/">Accessing Streaming Data via WebSocket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/examples/">Building with WebSockets: Code Samples in Python &amp; JavaScript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/example-rust/">Building with WebSockets: Code Sample in Rust</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/mempool-subscriptions/">Subscribing to Mempool Updates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/" aria-current="page">How to Backfill Data After a WebSocket Disconnection in Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/data-pipeline-writing-to-google-bigquery/">Data Pipeline: Writing to Google BigQuery</a><button aria-label="Toggle the collapsible sidebar category &#39;Data Pipeline: Writing to Google BigQuery&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/subscriptions/aws/s3_tutorial/">Using Bitquery Subscriptions to Load On-chain Data into S3</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/data-streams/">Data Streams</a><button aria-label="Toggle the collapsible sidebar category &#39;Data Streams&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/understanding-cubes/">Understanding Cubes</a><button aria-label="Toggle the collapsible sidebar category &#39;Understanding Cubes&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/l1-chains/">L1 Chains</a><button aria-label="Toggle the collapsible sidebar category &#39;L1 Chains&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/l2-chains/">L2 Chains</a><button aria-label="Toggle the collapsible sidebar category &#39;L2 Chains&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/how-to-guides/">How-To Guides</a><button aria-label="Toggle the collapsible sidebar category &#39;How-To Guides&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/data-in-cloud/">Data in Cloud</a><button aria-label="Toggle the collapsible sidebar category &#39;Data in Cloud&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/api-blog/">API Blog</a><button aria-label="Toggle the collapsible sidebar category &#39;API Blog&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="https://docs.bitquery.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.bitquery.io/docs/category/streaming/"><span itemprop="name">Streaming</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.bitquery.io/docs/category/streaming-via-subscriptions/"><span itemprop="name">Streaming via Subscriptions</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to Backfill Data After a WebSocket Disconnection in Python</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to Backfill Data After a WebSocket Disconnection in Python</h1><p>In this section, we'll discuss potential approaches to backfill data when stream disconnects. We will write code to receive live data, handles potential errors and disconnections, backfills any missing data during downtime, and ensures a graceful closure of connections. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>In this tutorial, we'll build a system that:</p><ol><li><strong>Subscribes to a live data stream via WebSocket.</strong></li><li><strong>Handles errors and detects disconnections.</strong></li><li><strong>Backfills any missing data during downtime by querying historical data.</strong></li><li><strong>Ensures the WebSocket connection is gracefully closed when necessary.</strong></li></ol><p><img loading="lazy" alt="flow" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/backfill-08a7862a0f5876e603ffb80107f39ae9.png" width="1024" height="768" class="img_ev3q"></p><p>We'll use Python's <code>asyncio</code> for asynchronous operations, the <code>gql</code> library for GraphQL interactions, and the <code>requests</code> library for HTTP requests.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2><p>Before diving into the implementation, ensure you have the following:</p><ul><li><strong>Python 3.7 or higher</strong> installed.</li><li><strong>Familiarity with WebSocket and GraphQL</strong>.</li><li><strong>API access to the Bitquery</strong>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-required-libraries">Installing Required Libraries<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#installing-required-libraries" class="hash-link" aria-label="Direct link to Installing Required Libraries" title="Direct link to Installing Required Libraries">​</a></h3><p>Use <code>pip</code> to install the necessary Python libraries:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">pip </span><span class="token function" style="color: rgb(80, 250, 123);">install</span><span class="token plain"> asyncio gql requests</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-architecture">System Architecture<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#system-architecture" class="hash-link" aria-label="Direct link to System Architecture" title="Direct link to System Architecture">​</a></h2><p>The system's workflow can be summarized as follows:</p><ol><li><strong>Live Subscription</strong>: Connect to the Bitquery Ethereum Subscription to receive real-time data.</li><li><strong>Error Handling</strong>: Monitor the connection for any issues or disconnections.</li><li><strong>Backfilling</strong>: Upon detecting a disconnection, query historical data to fill in any gaps.</li><li><strong>Graceful Closure</strong>: Properly close the WebSocket connection when done or when an error occurs.</li></ol><p>Let's delve into each component in detail.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-implementation">Step-by-Step Implementation<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#step-by-step-implementation" class="hash-link" aria-label="Direct link to Step-by-Step Implementation" title="Direct link to Step-by-Step Implementation">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-live-subscription">1. Live Subscription<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#1-live-subscription" class="hash-link" aria-label="Direct link to 1. Live Subscription" title="Direct link to 1. Live Subscription">​</a></h3><p><strong>Objective</strong>: Establish a live connection to the WebSocket API to receive real-time data.</p><p><strong>Implementation Details</strong>:</p><ul><li><strong>WebsocketsTransport</strong>: Used from the <code>gql</code> library to handle WebSocket connections.</li><li><strong>GraphQL Subscription</strong>: Defines the query to subscribe to live data.</li></ul><p><strong>Code Explanation</strong>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> asyncio</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> gql </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> Client</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> gql</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> gql</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">websockets </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> WebsocketsTransport</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> datetime</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We start by importing the necessary libraries. <code>asyncio</code> facilitates asynchronous operations, <code>gql</code> handles GraphQL queries and subscriptions, <code>requests</code> is used for HTTP requests during backfilling, and <code>datetime</code> manages time-related operations.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token comment" style="color: rgb(98, 114, 164);"># Bitquery streaming URL and OAuth token</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">url </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"https://streaming.bitquery.io/graphql"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">token </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"ory_at_...4"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Set up the streaming URL and your oAuth token. Replace <code>"ory_at_...4"</code> with your actual Bitquery token.</p><p><strong>Live Subscription Function</strong>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    transport </span><span class="token operator">=</span><span class="token plain"> WebsocketsTransport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        url</span><span class="token operator">=</span><span class="token string" style="color: rgb(255, 121, 198);">"wss://streaming.bitquery.io/graphql?token="</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> token</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        headers</span><span class="token operator">=</span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string" style="color: rgb(255, 121, 198);">"Sec-WebSocket-Protocol"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"graphql-ws"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">connect</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"connected"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">for</span><span class="token plain"> result </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">in</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            gql</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                subscription MyQuery {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                    EVM(network: eth) {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                        DEXTrades {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            Block {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            Transaction {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Hash</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            Trade {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Buy {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Dex {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    ProtocolName</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    ProtocolVersion</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Sell {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                        }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            """</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token comment" style="color: rgb(98, 114, 164);"># Processing incoming data</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"Live Data:"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> result</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">as</span><span class="token plain"> e</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Error during subscription: </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">finally</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">close</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Explanation</strong>:</p><ol><li><p><strong>Establish Connection</strong>: Create a <code>WebsocketsTransport</code> instance with the WebSocket URL and necessary headers. Connect to the WebSocket using <code>await transport.connect()</code>.</p></li><li><p><strong>Subscription</strong>: Use <code>transport.subscribe()</code> with a GraphQL subscription query to listen for live data (<code>DEXTrades</code> in this case).</p></li><li><p><strong>Data Handling</strong>: As live data comes in, it's printed out. In a real-world scenario, you'd process or store this data as needed.</p></li><li><p><strong>Error Handling</strong>: If any exception occurs during subscription, it's caught and printed.</p></li><li><p><strong>Graceful Closure</strong>: Regardless of success or failure, the WebSocket connection is closed using <code>await transport.close()</code>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-error-handling">2. Error Handling<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#2-error-handling" class="hash-link" aria-label="Direct link to 2. Error Handling" title="Direct link to 2. Error Handling">​</a></h3><p><strong>Objective</strong>: Detect and handle any network issues or exceptions that may disrupt the WebSocket connection.</p><p><strong>Implementation Details</strong>:</p><ul><li><strong>Try-Except Blocks</strong>: Used to catch and handle exceptions during the subscription.</li><li><strong>Logging Errors</strong>: Errors are printed for debugging purposes.</li></ul><p><strong>Code Explanation</strong>:</p><p>In the <code>subscribe</code> function, the <code>try-except-finally</code> block ensures that any exceptions during the subscription process are caught. If an error occurs, it's printed, and the connection is closed gracefully in the <code>finally</code> block.</p><p>Additionally, the <code>main</code> function is designed to catch exceptions from the <code>subscribe</code> function and trigger the backfilling process.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">handle_disconnection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Connection lost. Backfilling data from </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">start_time</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);"> to </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">end_time</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">."</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    asyncio</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">run</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">backfill_data</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>handle_disconnection</code> function is invoked when a disconnection is detected. It logs the disconnection and triggers the backfilling process for the time range between <code>start_time</code> and <code>end_time</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-backfilling-missing-data">3. Backfilling Missing Data<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#3-backfilling-missing-data" class="hash-link" aria-label="Direct link to 3. Backfilling Missing Data" title="Direct link to 3. Backfilling Missing Data">​</a></h3><p><strong>Objective</strong>: Retrieve any data that was missed during the disconnection period to ensure data completeness.</p><p><strong>Implementation Details</strong>:</p><ul><li><strong>Historical Data Query</strong>: In backfilling, the GraphQL query is essentially the same as the live subscription query, but instead of listening to real-time updates, we perform a  <strong>query</strong>  (instead of a  <strong>subscription</strong>) for historical data. The query includes an additional time filter to specify the period for which we want to retrieve the missing data.</li><li><strong>Time Filter</strong>: The query uses a  <code>where</code>  clause to filter data by a specific time range. The parameters  <code>since</code>  and  <code>till</code>  are added to ensure only data from the disconnected period is queried. This allows us to target the exact time window for which we need to backfill data.</li><li><strong>Time Range Calculation</strong>: The  <code>start_time</code>  (when the disconnection began) and  <code>end_time</code>  (when the connection is restored) are used to define the missing data period. This time range is passed into the backfill query to retrieve the missing trades or data.</li></ul><p><strong>Code Explanation</strong>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token comment" style="color: rgb(98, 114, 164);"># Function to backfill data for a given time range</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">backfill_data</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    query </span><span class="token operator">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">    {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">      EVM(network: eth) {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">        DEXTrades(where: {Block: {Time: {since: "%s", till: "%s"}}}) {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          Block {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          Transaction {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Hash</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          Trade {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Buy {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Dex {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              ProtocolName</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              ProtocolVersion</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Sell {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">        }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">      }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">    """</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token comment" style="color: rgb(98, 114, 164);"># Make an HTTP request to backfill missing data</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    headers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token string" style="color: rgb(255, 121, 198);">'Content-Type'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'application/json'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token string" style="color: rgb(255, 121, 198);">'Authorization'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"Bearer "</span><span class="token operator">+</span><span class="token plain">token</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">post</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">url</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> json</span><span class="token operator">=</span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string" style="color: rgb(255, 121, 198);">"query"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> query</span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">status_code </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">200</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        result </span><span class="token operator">=</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">json</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"Backfilled Data:"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> result</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">else</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"Failed to backfill data:"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">status_code</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">text</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Explanation</strong>:</p><ol><li><p><strong>GraphQL Query</strong>: The query fetches <code>DEXTrades</code> within the specified <code>start_time</code> and <code>end_time</code>. </p></li><li><p><strong>HTTP Request</strong>: Sends the query to the Bitquery API using an HTTP POST request with the necessary headers, including the authorization token.</p></li><li><p><strong>Response Handling</strong>: If the request is successful (<code>status_code == 200</code>), the backfilled data is printed. Otherwise, an error message with the status code and response text is displayed.</p></li></ol><p><strong>Note</strong>: In a production environment, instead of printing the data, you'd likely store it in a database or process it further.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-graceful-closure">4. Graceful Closure<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#4-graceful-closure" class="hash-link" aria-label="Direct link to 4. Graceful Closure" title="Direct link to 4. Graceful Closure">​</a></h3><p><strong>Objective</strong>: Ensure that the WebSocket connection is properly closed when it's no longer needed or when an error occurs.</p><p><strong>Implementation Details</strong>:</p><ul><li><strong>Finally Block</strong>: Ensures the connection is closed regardless of success or failure.</li><li><strong>Explicit Closure</strong>: Uses <code>await transport.close()</code> to terminate the WebSocket connection.</li></ul><p><strong>Code Explanation</strong>:</p><p>Within the <code>subscribe</code> function, the <code>finally</code> block guarantees that the WebSocket connection is closed even if an error occurs during data streaming. This prevents resource leaks and ensures that the connection state is cleanly managed.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">finally</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">close</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Additionally, the <code>handle_disconnection</code> function ensures that any necessary cleanup or data retrieval occurs when a disconnection is detected.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="putting-it-all-together">Putting It All Together<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#putting-it-all-together" class="hash-link" aria-label="Direct link to Putting It All Together" title="Direct link to Putting It All Together">​</a></h3><p><strong>Main Function</strong>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token comment" style="color: rgb(98, 114, 164);"># Main function to run the subscription and detect disconnection</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    start_time </span><span class="token operator">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">now</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">timezone</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">utc</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">as</span><span class="token plain"> e</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Disconnection detected: </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        end_time </span><span class="token operator">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">now</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">timezone</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">utc</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token comment" style="color: rgb(98, 114, 164);"># Call backfill function to handle missing data</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        handle_disconnection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">isoformat</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">isoformat</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Explanation</strong>:</p><ol><li><p><strong>Start Time</strong>: Records the current UTC time before initiating the subscription.</p></li><li><p><strong>Subscription</strong>: Awaits the <code>subscribe</code> function to start receiving live data.</p></li><li><p><strong>Exception Handling</strong>: If an exception occurs (indicating a disconnection), it captures the current time as <code>end_time</code> and calls <code>handle_disconnection</code> to backfill data for the period between <code>start_time</code> and <code>end_time</code>.</p></li></ol><p><strong>Running the Event Loop</strong>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token comment" style="color: rgb(98, 114, 164);"># Run the asyncio event loop</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">asyncio</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">run</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This line starts the asynchronous event loop, executing the <code>main</code> function.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="complete-code">Complete Code<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#complete-code" class="hash-link" aria-label="Direct link to Complete Code" title="Direct link to Complete Code">​</a></h2><p>Here's the complete code assembled from the components discussed:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> asyncio</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> gql </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> Client</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> gql</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> gql</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">websockets </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> WebsocketsTransport</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Bitquery streaming URL and API token</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">url </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"https://streaming.bitquery.io/graphql"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">token </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"ory_at_...4"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Function to backfill data for a given time range</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">backfill_data</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    query </span><span class="token operator">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">    {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">      EVM(network: eth) {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">        DEXTrades(where: {Block: {Time: {since: "%s", till: "%s"}}}) {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          Block {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          Transaction {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Hash</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          Trade {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Buy {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Dex {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              ProtocolName</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              ProtocolVersion</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            Sell {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">              }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">          }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">        }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">      }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">    """</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token comment" style="color: rgb(98, 114, 164);"># Make an HTTP request to backfill missing data</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    headers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token string" style="color: rgb(255, 121, 198);">'Content-Type'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'application/json'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token string" style="color: rgb(255, 121, 198);">'Authorization'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"Bearer "</span><span class="token operator">+</span><span class="token plain">token</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">post</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">url</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> json</span><span class="token operator">=</span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string" style="color: rgb(255, 121, 198);">"query"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> query</span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">status_code </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">200</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        result </span><span class="token operator">=</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">json</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"Backfilled Data:"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> result</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">else</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"Failed to backfill data:"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">status_code</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> response</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">text</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Function to subscribe to live data stream</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    transport </span><span class="token operator">=</span><span class="token plain"> WebsocketsTransport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        url</span><span class="token operator">=</span><span class="token string" style="color: rgb(255, 121, 198);">"wss://streaming.bitquery.io/graphql?token="</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> token</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        headers</span><span class="token operator">=</span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string" style="color: rgb(255, 121, 198);">"Sec-WebSocket-Protocol"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"graphql-ws"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">connect</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"connected"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">for</span><span class="token plain"> result </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">in</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            gql</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">"""</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                subscription MyQuery {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                    EVM(network: eth) {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                        DEXTrades {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            Block {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Time</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            Transaction {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Hash</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            Trade {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Buy {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Dex {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    ProtocolName</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    ProtocolVersion</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                Sell {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Buyer</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    AmountInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Amount</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Seller</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    PriceInUSD</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Price</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    Currency {</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Name</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                        SmartContract</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                            }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                        }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                    }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">                }</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token triple-quoted-string string" style="color: rgb(255, 121, 198);">            """</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token comment" style="color: rgb(98, 114, 164);"># Processing incoming data</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"Live Data:"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> result</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">as</span><span class="token plain"> e</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Error during subscription: </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">finally</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> transport</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">close</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Function to calculate time range and trigger backfill</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">handle_disconnection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Connection lost. Backfilling data from </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">start_time</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);"> to </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">end_time</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">."</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    asyncio</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">run</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">backfill_data</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Main function to run the subscription and detect disconnection</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">async</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    start_time </span><span class="token operator">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">now</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">timezone</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">utc</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">await</span><span class="token plain"> subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">as</span><span class="token plain"> e</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Disconnection detected: </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        end_time </span><span class="token operator">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">now</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">datetime</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">timezone</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">utc</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token comment" style="color: rgb(98, 114, 164);"># Call backfill function to handle missing data</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        handle_disconnection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">start_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">isoformat</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">isoformat</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token comment" style="color: rgb(98, 114, 164);"># Run the asyncio event loop</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">asyncio</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">run</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-system">Running the System<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#running-the-system" class="hash-link" aria-label="Direct link to Running the System" title="Direct link to Running the System">​</a></h2><ol><li><p><strong>Configure OAuth Token</strong>: Replace <code>"ory_at_...4"</code> with your actual Bitquery token.</p></li><li><p><strong>Execute the Script</strong>: Run the script using Python.</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">python your_script_name.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li><strong>Monitor Output</strong>: The console will display messages indicating successful connections, live data, any errors, and backfilled data as needed.</li></ol><p><strong>Example Output</strong>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">connected</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Live Data: {...}  # Real-time data received</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Error during subscription: Connection closed unexpectedly</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Disconnection detected: Connection closed unexpectedly</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Connection lost. Backfilling data from 2024-10-14T12:00:00+00:00 to 2024-10-14T12:05:00+00:00.</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">Backfilled Data: {...}  # Historical data fetched to fill the gap</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-approach-using-block-heights-to-backfill-data">Alternative Approach: Using Block Heights to Backfill Data<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#alternative-approach-using-block-heights-to-backfill-data" class="hash-link" aria-label="Direct link to Alternative Approach: Using Block Heights to Backfill Data" title="Direct link to Alternative Approach: Using Block Heights to Backfill Data">​</a></h2><p>You can implement an alternative approach that uses block heights instead of relying on time periods. </p><ol><li><strong>Track the Last Processed Block Height</strong>: Continuously update and save the latest block height received from the live data stream.</li><li><strong>Detect Disconnections</strong>: Monitor the WebSocket connection for any interruptions.</li><li><strong>Backfill Missing Data</strong>: Using historical query, use the last saved block height to query and retrieve data from the missed blocks.</li><li><strong>Update the Last Processed Block Height</strong>: After successful backfilling, update the saved block height to reflect the latest processed block.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>In this tutorial, we built a resilient real-time data streaming system using Python. The system effectively manages live data subscriptions, handles errors and disconnections, backfills any missing data to maintain data integrity, and ensures that connections are gracefully closed when necessary.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bitquery/streaming-data-platform-docs/tree/main/docs/subscriptions/backfilling-subscription.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="https://docs.bitquery.io/docs/subscriptions/mempool-subscriptions/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Subscribing to Mempool Updates</div></a><a class="pagination-nav__link pagination-nav__link--next" href="https://docs.bitquery.io/docs/category/data-pipeline-writing-to-google-bigquery/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Data Pipeline: Writing to Google BigQuery</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#installing-required-libraries" class="table-of-contents__link toc-highlight">Installing Required Libraries</a></li></ul></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#system-architecture" class="table-of-contents__link toc-highlight">System Architecture</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#step-by-step-implementation" class="table-of-contents__link toc-highlight">Step-by-Step Implementation</a><ul><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#1-live-subscription" class="table-of-contents__link toc-highlight">1. Live Subscription</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#2-error-handling" class="table-of-contents__link toc-highlight">2. Error Handling</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#3-backfilling-missing-data" class="table-of-contents__link toc-highlight">3. Backfilling Missing Data</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#4-graceful-closure" class="table-of-contents__link toc-highlight">4. Graceful Closure</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#putting-it-all-together" class="table-of-contents__link toc-highlight">Putting It All Together</a></li></ul></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#complete-code" class="table-of-contents__link toc-highlight">Complete Code</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#running-the-system" class="table-of-contents__link toc-highlight">Running the System</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#alternative-approach-using-block-heights-to-backfill-data" class="table-of-contents__link toc-highlight">Alternative Approach: Using Block Heights to Backfill Data</a></li><li><a href="https://docs.bitquery.io/docs/subscriptions/backfilling-subscription/#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://bitquery.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://docs.bitquery.io/v1/" target="_blank" rel="noopener noreferrer" class="footer__link-item">V1 Docs</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.bitquery.io/docs/intro/">V2 Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/Bloxy_info" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Bitquery_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://community.bitquery.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/bitquery" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://bitquery.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Bitquery, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/runtime~main.402cce67.js.Без названия"></script>
<script src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/main.b44c1ae9.js.Без названия"></script>


<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<div class="go2933276541 go2369186930" id="hs-web-interactives-top-anchor"><div id="hs-interactives-modal-overlay" class="go1632949049"></div></div>
<div class="go2933276541 go1348078617" id="hs-web-interactives-bottom-anchor"></div>
<div id="hs-web-interactives-floating-container">
  <div id="hs-web-interactives-floating-top-left-anchor" class="go2417249464 go613305155">
  </div>
  <div id="hs-web-interactives-floating-top-right-anchor" class="go2417249464 go471583506">
  </div>
  <div id="hs-web-interactives-floating-bottom-left-anchor" class="go2417249464 go3921366393">
  </div>
  <div id="hs-web-interactives-floating-bottom-right-anchor" class="go2417249464 go3967842156">
  </div>
</div><iframe height="0" width="0" data-gtm-yt-inspected-8="true" style="display: none; visibility: hidden;" data-gtm-yt-inspected-20="true" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/saved_resource.html"></iframe>
<style>
#chatbase-bubble-button,
#chatbase-bubble-button * {
margin: 0;
padding: 0;
box-sizing: border-box;
}
html.__cb_widget_active,
html.__cb_widget_active body {
position: fixed !important;
top: 0;
left: 0;
overscroll-behavior: none;
width: 0 !important;
height: 0 !important;
margin: 0 !important;
overflow: hidden !important;
overflow-y: hidden !important;
overflow-x: hidden !important;
transform: none !important;
}

#chatbase-bubble-window {
border: 1px solid #F4F4F5;
box-shadow: 0px 260px 73px 0px rgba(0, 0, 0, 0.00), 0px 166px 67px 0px rgba(0, 0, 0, 0.01), 0px 94px 56px 0px rgba(0, 0, 0, 0.02), 0px 42px 42px 0px rgba(0, 0, 0, 0.03), 0px 10px 23px 0px rgba(0, 0, 0, 0.04);
backdrop-filter: blur(4px);
-webkit-backdrop-filter: blur(4px);
}

</style><div id="chatbase-message-bubbles" style="position: fixed; bottom: 85px; border-radius: 10px; font-family: sans-serif; font-size: 16px; z-index: 2147483644; cursor: pointer; flex-direction: column; gap: 50px; max-width: 70vw; display: none; right: 1rem; left: unset;"><div style="position: absolute; top: -7px; right: -7px; font-weight: bold; display: none; justify-content: center; align-items: center; z-index: 2147483643; width: 22px; height: 22px; border-radius: 50%; text-align: center; font-size: 12px; cursor: pointer; background-color: rgb(224, 224, 224); color: black; box-shadow: rgba(150, 150, 150, 0.15) 0px 6px 24px 0px, rgba(150, 150, 150, 0.15) 0px 0px 0px 1px;">✕</div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">Which Query or API can I help you build? (Please mention the blockchain name and be precise)</div></div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">For additional questions, please contact us on Telegram (https://t.me/Bloxy_info)</div></div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">Note that this chat only answer questions about API v2 and API EAP. For questions on API v1 please select appropriate API endpoint from the list in IDE.</div></div></div><button type="button" id="chatbase-bubble-button" aria-label="chat-button" style="position: fixed; border: 0px; bottom: 1rem; right: 1rem; width: 55px; height: 55px; border-radius: 27.5px; background-color: rgb(144, 19, 254); box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px 0px; cursor: pointer; z-index: 2147483645; transition: 0.2s ease-in-out; left: unset; transform: scale(1);"><div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; z-index: 2147483646;"><svg width="55" height="55" viewBox="0 0 1120 1120" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M252 434C252 372.144 302.144 322 364 322H770C831.856 322 882 372.144 882 434V614.459L804.595 585.816C802.551 585.06 800.94 583.449 800.184 581.405L763.003 480.924C760.597 474.424 751.403 474.424 748.997 480.924L711.816 581.405C711.06 583.449 709.449 585.06 707.405 585.816L606.924 622.997C600.424 625.403 600.424 634.597 606.924 637.003L707.405 674.184C709.449 674.94 711.06 676.551 711.816 678.595L740.459 756H629.927C629.648 756.476 629.337 756.945 628.993 757.404L578.197 825.082C572.597 832.543 561.403 832.543 555.803 825.082L505.007 757.404C504.663 756.945 504.352 756.476 504.073 756H364C302.144 756 252 705.856 252 644V434ZM633.501 471.462C632.299 468.212 627.701 468.212 626.499 471.462L619.252 491.046C618.874 492.068 618.068 492.874 617.046 493.252L597.462 500.499C594.212 501.701 594.212 506.299 597.462 507.501L617.046 514.748C618.068 515.126 618.874 515.932 619.252 516.954L626.499 536.538C627.701 539.788 632.299 539.788 633.501 536.538L640.748 516.954C641.126 515.932 641.932 515.126 642.954 514.748L662.538 507.501C665.788 506.299 665.788 501.701 662.538 500.499L642.954 493.252C641.932 492.874 641.126 492.068 640.748 491.046L633.501 471.462Z" fill="white"></path>
<path d="M771.545 755.99C832.175 755.17 881.17 706.175 881.99 645.545L804.595 674.184C802.551 674.94 800.94 676.551 800.184 678.595L771.545 755.99Z" fill="white"></path>
</svg>            
</div></button><div id="chatbase-bubble-window" style="border: none; position: fixed; flex-direction: column; justify-content: space-between; bottom: 85px; right: 1rem; width: 406px; height: 85dvh; max-height: 824px; border-radius: 1.25rem; display: none; z-index: 2147483646; overflow: hidden; background-color: white; left: unset;"><div style="display: none; justify-content: center; height: 100%; align-items: center;"><svg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" stroke="black" style="width:30px;height:30px;">
  <g>
      <rect x="11" y="1" width="2" height="5" opacity=".14"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(30 12 12)" opacity=".29"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(60 12 12)" opacity=".43"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(90 12 12)" opacity=".57"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(120 12 12)" opacity=".71"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(150 12 12)" opacity=".86"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(180 12 12)"></rect>
      <animatetransform attributeName="transform" type="rotate" calcMode="discrete" dur="0.75s" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12" repeatCount="indefinite"></animatetransform>
  </g>
</svg></div><iframe data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" title="Chatbot" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/Vz0cwoEYRJW6n5B2JeSeu.html" style="height: 100%; width: 100%; border: none; display: block;"></iframe></div>
<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150579562" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312.html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe><script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150603670" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(1).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150607124" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(2).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150609447" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(3).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150630348" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(4).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150648757" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(5).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>

<iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150680741" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(6).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe><script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150703432" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(7).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150777937" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(8).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe><script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752150795949" height="0" width="0" src="./How to Backfill Data After a WebSocket Disconnection in Python _ Blockchain Data API (V2)_files/11376996312(9).html" data-gtm-yt-inspected-8="true" data-gtm-yt-inspected-20="true" style="display: none; visibility: hidden;"></iframe>
</body></html>