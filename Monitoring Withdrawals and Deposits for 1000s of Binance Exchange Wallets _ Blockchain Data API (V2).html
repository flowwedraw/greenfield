<!DOCTYPE html>
<!-- saved from url=(0074)https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/ -->
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-usecases/binance-exchange-wallet-monitoring" data-has-hydrated="true" data-theme="dark" data-rh="lang,dir,class,data-has-hydrated"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="Docusaurus v2.4.3">
<title>Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets | Blockchain Data API (V2)</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.bitquery.io/img/heroImage4.png"><meta data-rh="true" name="twitter:image" content="https://docs.bitquery.io/img/heroImage4.png"><meta data-rh="true" property="og:url" content="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets | Blockchain Data API (V2)"><meta data-rh="true" name="description" content="In this guide we will utilize the Protobuf Kafka streams provided by Bitquery to monitor withdrawls and deposits for a large number of Binance Exchange Wallets on BSC network. Read this document to know more about why Kafka streams are prefered for building scalable, enterprise grade solutions over other solutions by Bitquery such as Websocket streams and GraphQL API. You can read more about Kafka solution by Bitquery here."><meta data-rh="true" property="og:description" content="In this guide we will utilize the Protobuf Kafka streams provided by Bitquery to monitor withdrawls and deposits for a large number of Binance Exchange Wallets on BSC network. Read this document to know more about why Kafka streams are prefered for building scalable, enterprise grade solutions over other solutions by Bitquery such as Websocket streams and GraphQL API. You can read more about Kafka solution by Bitquery here."><link data-rh="true" rel="icon" href="https://docs.bitquery.io/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/"><link data-rh="true" rel="alternate" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="https://docs.bitquery.io/blog/rss.xml" title="Blockchain Data API (V2) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="https://docs.bitquery.io/blog/atom.xml" title="Blockchain Data API (V2) Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com/">
<link rel="preconnect" href="https://www.googletagmanager.com/">
<script type="text/javascript" async="" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/js"></script><script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/fb.js.Без названия" type="text/javascript" id="hs-ads-pixel-6314272" data-ads-portal-id="6314272" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/web-interactives-embed.js.Без названия" type="text/javascript" id="hubspot-web-interactives-loader" crossorigin="anonymous" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/leadflows.js.Без названия" type="text/javascript" id="LeadFlows-6314272" crossorigin="anonymous" data-leadin-portal-id="6314272" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/banner.js.Без названия" type="text/javascript" id="cookieBanner-6314272" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="6314272" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/6314272.js.Без названия" type="text/javascript" id="hs-analytics"></script><script async="" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/gtm.js.Без названия"></script><script async="" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/js(1)"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ZWB80TDH9J",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com/">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-5GC69JH6",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>




<script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/embed.min.js.Без названия" async="" id="Vz0cwoEYRJW6n5B2JeSeu" domain="www.chatbase.co"></script>
<script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/chatbase-open.js.Без названия" defer="defer"></script><link rel="stylesheet" href="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/styles.2db95959.css">
<link rel="preload" href="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/runtime~main.94f1a4d2.js.Без названия" as="script">
<link rel="preload" href="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/main.19751415.js.Без названия" as="script">
<meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><style id="_goober"> .go2933276541{position:fixed;display:block;width:100%;height:0px;margin:0px;padding:0px;overflow:visible;transform-style:preserve-3d;background:transparent;backface-visibility:hidden;pointer-events:none;left:0px;z-index:9998;}.go2369186930{top:0px;z-index:9999;height:100%;width:100%;}.go1348078617{bottom:0px;}.go2417249464{position:fixed;z-index:9989;}.go3921366393{left:0;bottom:0;}.go3967842156{right:0;bottom:0;}.go613305155{left:0;top:0;}.go471583506{right:0;top:0;}.go3670563033{position:relative;overflow:hidden;display:none;}.go1041095097{display:block;}.go1632949049{position:absolute;pointer-events:none;width:101vw;height:101vh;background:rgba(0,0,0,0.7);opacity:0;z-index:-1;}.go2512015367{z-index:99998;opacity:0.8;visibility:visible;pointer-events:all;cursor:pointer;}.go1432718904{overflow:hidden;}.go812842568{display:block !important;position:static !important;box-sizing:border-box !important;background:transparent !important;border:none;min-height:0px !important;max-height:none !important;margin:0px;padding:0px !important;height:100% !important;width:1px !important;max-width:100% !important;min-width:100% !important;}.go4194603687{z-index:99999;visibility:hidden;position:absolute;inset:50vh auto auto 50%;transform:translate(-50%,-50%);left:50%;top:150%;pointer-events:none;max-height:95%;max-width:95%;}.go4258295619{pointer-events:auto !important;visibility:visible;top:50%;transition:top 0.75s linear(0,0.006,0.023 2.2%,0.096 4.8%,0.532 15.4%,0.72 21%,0.793,0.853 26.7%,0.902,0.941,0.968 36.2%,0.987 39.7%,1 43.7%,1.007 48.3%,1.009 55.3%,1.002 78.2%,1 );}.go456419034{transition:opacity 0.3s ease-in;}.go3128134379{pointer-events:auto !important;visibility:visible !important;max-height:95vh !important;transition:max-height 1s ease-in;}.go494047706{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;}.go2481764524{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;bottom:0px;}.go2685733372{visibility:hidden;}.go2985984737{visibility:visible !important;}.go3281949485{pointer-events:auto !important;visibility:visible !important;max-height:95vh !important;transform:none !important;}.go3508454897{z-index:9999;width:100%;max-height:95%;position:fixed;visibility:hidden;transition:transform 1s linear(0,0.006,0.022 2.3%,0.091 5.1%,0.18 7.6%,0.508 16.3%,0.607,0.691,0.762,0.822 28.4%,0.872,0.912 35.1%,0.944 38.9%,0.968 43%,0.985 47.6%,0.996 53.1%,1.001 58.4%,1.003 65.1%,1 );}.go988075951{z-index:9999;position:fixed;left:10px;top:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go2699082514{z-index:9999;position:fixed;right:10px;top:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go1595992025{z-index:9999;position:fixed;left:10px;bottom:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go1222083472{z-index:9999;position:fixed;right:10px;bottom:10px;max-height:95vh !important;max-width:95%;visibility:hidden;}.go722322694{transition:none !important;}.go26732895{cursor:pointer;}.go2083580917{display:flex;justify-content:center;align-items:center;}</style><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/a468e46b.901c42bb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/da57af4e.999dd7e9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/0e384e19.1ec5afa4.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/c4f5d8e4.e98f0852.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/ad776868.2e6af93e.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/137b7510.c0c07b49.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/951a1f5d.00934596.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b70f6985.55e46717.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4144071c.ce143a28.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4bd2478d.bd11c6a0.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b2389277.bfe41362.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/3d6d56b6.86cc964c.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b9910d88.1e97d040.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/41fa0d41.e7b7df6f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/6d84b776.e0364f6a.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/49bb8dc3.e1fca388.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/b8418c0b.68b78aa6.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/14eb3368.95e2c8f9.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/4ad85961.66bc2132.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/da7cc36a.89881bfa.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/83e8900e.b124aecc.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/fc0e69bb.868b5e1d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/1be78505.37d1a6eb.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/9bd7a39a.cad4388d.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/935f2afb.c0a2ce1f.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/17896441.1b04066b.js"><link rel="prefetch" href="https://docs.bitquery.io/assets/js/92040533.ecb524a3.js"><script async="" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/js(2)"></script><script type="text/javascript" async="" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/f.txt"></script></head>
<body class="" data-theme="dark" data-rh="class,data-theme" style="overflow: visible;"><div id="hs-web-interactives-top-push-anchor" class="go3670563033"></div>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5GC69JH6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="https://docs.bitquery.io/"><div class="navbar__logo"><img src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/logoBitqueryWhite.png" alt="Bitquery.io" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a href="https://docs.bitquery.io/v1/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">V1 Docs</a><a aria-current="page" class="navbar__item navbar__link v2-highlight navbar__link--active" href="https://docs.bitquery.io/docs/intro/">V2 Docs</a><a href="https://bitquery.io/forms/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Book Demo</a><a href="https://dexrabbit.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DEX Dashboard</a><a href="https://lite.bitquery.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Free Investigation Tool</a><a href="https://bitquery.substack.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Newsletter</a></div><div class="navbar__items navbar__items--right"><a href="https://account.bitquery.io/user/api_v2/access_tokens" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Get your free Access Token</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP" type="button" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"><div class="aa-Autocomplete" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="autocomplete-0-label"><button type="button" class="aa-DetachedSearchButton"><div class="aa-DetachedSearchButtonIcon"><svg class="aa-SubmitIcon" viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M16.041 15.856c-0.034 0.026-0.067 0.055-0.099 0.087s-0.060 0.064-0.087 0.099c-1.258 1.213-2.969 1.958-4.855 1.958-1.933 0-3.682-0.782-4.95-2.050s-2.050-3.017-2.050-4.95 0.782-3.682 2.050-4.95 3.017-2.050 4.95-2.050 3.682 0.782 4.95 2.050 2.050 3.017 2.050 4.95c0 1.886-0.745 3.597-1.959 4.856zM21.707 20.293l-3.675-3.675c1.231-1.54 1.968-3.493 1.968-5.618 0-2.485-1.008-4.736-2.636-6.364s-3.879-2.636-6.364-2.636-4.736 1.008-6.364 2.636-2.636 3.879-2.636 6.364 1.008 4.736 2.636 6.364 3.879 2.636 6.364 2.636c2.125 0 4.078-0.737 5.618-1.968l3.675 3.675c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414z"></path></svg></div><div class="aa-DetachedSearchButtonPlaceholder">Search...</div><div class="aa-DetachedSearchButtonQuery"></div></button></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="https://docs.bitquery.io/docs/intro/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="https://docs.bitquery.io/docs/api-comparison/">API Comparison</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/start/">Start</a><button aria-label="Toggle the collapsible sidebar category &#39;Start&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/authorisation/">Authorisation</a><button aria-label="Toggle the collapsible sidebar category &#39;Authorisation&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/using-the-ide/">Using the IDE</a><button aria-label="Toggle the collapsible sidebar category &#39;Using the IDE&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/building-queries/">Building Queries</a><button aria-label="Toggle the collapsible sidebar category &#39;Building Queries&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/streaming/">Streaming</a><button aria-label="Toggle the collapsible sidebar category &#39;Streaming&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/understanding-cubes/">Understanding Cubes</a><button aria-label="Toggle the collapsible sidebar category &#39;Understanding Cubes&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/l1-chains/">L1 Chains</a><button aria-label="Toggle the collapsible sidebar category &#39;L1 Chains&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/l2-chains/">L2 Chains</a><button aria-label="Toggle the collapsible sidebar category &#39;L2 Chains&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="https://docs.bitquery.io/docs/category/how-to-guides/">How-To Guides</a><button aria-label="Toggle the collapsible sidebar category &#39;How-To Guides&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/usecases/MCP/">Building MCPs using Bitquery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/nft-applications/">NFT Applications</a><button aria-label="Toggle the collapsible sidebar category &#39;NFT Applications&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/tradingview-charting/">TradingView Charting</a><button aria-label="Toggle the collapsible sidebar category &#39;TradingView Charting&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="https://docs.bitquery.io/docs/category/building-applications-using-kafka/">Building Applications Using Kafka</a><button aria-label="Toggle the collapsible sidebar category &#39;Building Applications Using Kafka&#39;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/">Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/">How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/blockchain-monitoring/">Blockchain Monitoring</a><button aria-label="Toggle the collapsible sidebar category &#39;Blockchain Monitoring&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/apps-and-dashboards/">Apps and Dashboards</a><button aria-label="Toggle the collapsible sidebar category &#39;Apps and Dashboards&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="https://docs.bitquery.io/docs/category/bot-building/">Bot Building</a><button aria-label="Toggle the collapsible sidebar category &#39;Bot Building&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/data-in-cloud/">Data in Cloud</a><button aria-label="Toggle the collapsible sidebar category &#39;Data in Cloud&#39;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="https://docs.bitquery.io/docs/category/api-blog/">API Blog</a><button aria-label="Toggle the collapsible sidebar category &#39;API Blog&#39;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="https://docs.bitquery.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.bitquery.io/docs/category/how-to-guides/"><span itemprop="name">How-To Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="https://docs.bitquery.io/docs/category/building-applications-using-kafka/"><span itemprop="name">Building Applications Using Kafka</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets</h1><p>In this guide we will utilize the <a href="https://docs.bitquery.io/docs/streams/protobuf/kafka-protobuf-python/">Protobuf Kafka streams</a> provided by Bitquery to monitor withdrawls and deposits for a large number of Binance Exchange Wallets on BSC network. Read <a href="https://docs.bitquery.io/docs/streams/compare-websocket-kafka/">this</a> document to know more about why Kafka streams are prefered for building scalable, enterprise grade solutions over other solutions by Bitquery such as Websocket streams and GraphQL API. You can read more about Kafka solution by Bitquery <a href="https://docs.bitquery.io/docs/streams/kafka-streaming-concepts/">here</a>.</p><p>Checkout the complete <a href="https://github.com/bitquery/binance-exchange-wallets-monitoring" target="_blank" rel="noopener noreferrer">codebase</a> for any issues in the tutorial.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2><ol><li>Create a project folder with the given command.</li></ol><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token function" style="color: rgb(80, 250, 123);">mkdir</span><span class="token plain"> bsc-exchange-wallet-monitoring</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Install the dependencies using the command line.</li></ol><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">pip </span><span class="token function" style="color: rgb(80, 250, 123);">install</span><span class="token plain"> bitquery-pb2-kafka-package</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Create the file structure with the following commands.</li></ol><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token function" style="color: rgb(80, 250, 123);">touch</span><span class="token plain"> main.py</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token function" style="color: rgb(80, 250, 123);">mkdir</span><span class="token plain"> helpers</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token builtin class-name" style="color: rgb(189, 147, 249);">cd</span><span class="token plain"> helpers</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token function" style="color: rgb(80, 250, 123);">touch</span><span class="token plain"> convert_bytes.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="helper-functions">Helper Functions<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#helper-functions" class="hash-link" aria-label="Direct link to Helper Functions" title="Direct link to Helper Functions">​</a></h2><p>In this section we will discuss the code written inside the helpers folder.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="convert-bytes">Convert Bytes<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#convert-bytes" class="hash-link" aria-label="Direct link to Convert Bytes" title="Direct link to Convert Bytes">​</a></h3><p>This functions takes the base58 encoded bytes as parameter and returns readable string values.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> base58</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">convert_bytes</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">value</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> encoding</span><span class="token operator">=</span><span class="token string" style="color: rgb(255, 121, 198);">'hex'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> encoding </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'base58'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">return</span><span class="token plain"> base58</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">b58encode</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">value</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">decode</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">else</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">return</span><span class="token plain"> value</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token builtin" style="color: rgb(189, 147, 249);">hex</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="imports">Imports<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#imports" class="hash-link" aria-label="Direct link to Imports" title="Direct link to Imports">​</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> uuid</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> confluent_kafka </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> Consumer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> KafkaError</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> KafkaException</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> google</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">protobuf</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">message </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> DecodeError</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> evm </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> token_block_message_pb2</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> binascii</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> base58</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> helpers</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">convert_bytes </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> convert_bytes </span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">from</span><span class="token plain"> helpers</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">print_protobuf_message </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">import</span><span class="token plain"> print_protobuf_message</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-kafka-configuration">Creating Kafka Configuration<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#creating-kafka-configuration" class="hash-link" aria-label="Direct link to Creating Kafka Configuration" title="Direct link to Creating Kafka Configuration">​</a></h2><p>The credentials such as <code>username</code> and <code>password</code> could be received by contacting the Bitquery team via - <a href="mailto:sales@bitquery.io" target="_blank" rel="noopener noreferrer">sales@bitquery.io</a></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">group_id_suffix </span><span class="token operator">=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">uuid4</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token builtin" style="color: rgb(189, 147, 249);">hex</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">conf </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'bootstrap.servers'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'rpk0.bitquery.io:9092,rpk1.bitquery.io:9092,rpk2.bitquery.io:9092'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'group.id'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f'</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">username</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">-group-</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">group_id_suffix</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain">  </span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'session.timeout.ms'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token number">30000</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'security.protocol'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'SASL_PLAINTEXT'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'ssl.endpoint.identification.algorithm'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'none'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'sasl.mechanisms'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'SCRAM-SHA-512'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'sasl.username'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> username</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'sasl.password'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> password</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'auto.offset.reset'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'latest'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-consumer-and-subcribing-to-topic">Creating Consumer and Subcribing to Topic<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#creating-consumer-and-subcribing-to-topic" class="hash-link" aria-label="Direct link to Creating Consumer and Subcribing to Topic" title="Direct link to Creating Consumer and Subcribing to Topic">​</a></h2><p>The topic to subscribe should be selected based on the usecase. In this case we are looking to track the deposits and withrawls of tokens for a list of Binance Exchange Wallets, thus <code>bsc.tokens.proto</code> would be the best choice.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">consumer </span><span class="token operator">=</span><span class="token plain"> Consumer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">conf</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">topic </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'bsc.tokens.proto'</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">consumer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">[</span><span class="token plain">topic</span><span class="token punctuation" style="color: rgb(248, 248, 242);">]</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-set-of-binance-exchange-wallets">Creating Set of Binance Exchange Wallets<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#creating-set-of-binance-exchange-wallets" class="hash-link" aria-label="Direct link to Creating Set of Binance Exchange Wallets" title="Direct link to Creating Set of Binance Exchange Wallets">​</a></h2><p>For the purpose of tutorial we have directly created a set containing a bunch of Binance exchange wallet addresses. When building an enterprise grade solution where the number of wallets are in thousands or millions, the set could be saved in a seperate file. The wallets are stored in a set instead of list due to fast lookup in sets.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">wallets </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0xf977814e90da44bfa03b6295a0616a897441acec'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0xBE0eB53F46cd790Cd13851d5EFf43D12404d33E8'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x5a52e96bacdabb82fd05763e25335261b270efcb'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x3c783c21a0383057d128bae431894a5c19f9cf06'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0xdccf3b77da55107280bd850ea519df3705d1a75a'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x8894e0a0c962cb723c1976a4421c95949be2d4e3'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x515b72ed8a97f42c568d6a143232775018f133c8'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0xbd612a3f30dca67bf60a39fd0d35e39b7ab80774'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x01c952174c24e1210d26961d456a77a39e1f0bb0'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x29bdfbf7d27462a2d115748ace2bd71a2646946c'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x73f5ebe90f27b46ea12e5795d16c4b408b19cc6f'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x161ba15a5f335c9f06bb5bbb0a9ce14076fbb645'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0x1fbe2acee135d991592f167ac371f3dd893a508b'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0xeb2d2f1b8c558a40207669291fda468e50c8a0bb'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token string" style="color: rgb(255, 121, 198);">'0xa180fe01b906a1be37be6c534a3300785b20d947'</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="proccess-message-function">Proccess Message Function<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#proccess-message-function" class="hash-link" aria-label="Direct link to Proccess Message Function" title="Direct link to Proccess Message Function">​</a></h2><p>This function receives the message from the stream as a parameter. The message contains a list of token transfers and the function checks if either of the <code>sender</code> or <code>receiver</code> are present in the set defined earlier. If either of the condition is satisfied then it prints the message displayed in the <a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#final-result">Final Results</a> section.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">def</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">process_message</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">message</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token builtin" style="color: rgb(189, 147, 249);">buffer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> message</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">value</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        parsed_message </span><span class="token operator">=</span><span class="token plain"> token_block_message_pb2</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">TokenBlockMessage</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        parsed_message</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">ParseFromString</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token builtin" style="color: rgb(189, 147, 249);">buffer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        transfers </span><span class="token operator">=</span><span class="token plain"> parsed_message</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">Transfers</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">for</span><span class="token plain"> transfer </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">in</span><span class="token plain"> transfers</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            sender </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'0x'</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> convert_bytes</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">transfer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">Sender</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            receiver </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">'0x'</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> convert_bytes</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">transfer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">Receiver</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            amount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color: rgb(189, 147, 249);">int</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">from_bytes</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">transfer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">Amount</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> byteorder</span><span class="token operator">=</span><span class="token string" style="color: rgb(255, 121, 198);">'big'</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token operator">/</span><span class="token number">10e18</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            currency </span><span class="token operator">=</span><span class="token plain"> transfer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">Currency</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            symbol </span><span class="token operator">=</span><span class="token plain"> currency</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">Symbol</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> sender </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">in</span><span class="token plain"> wallets</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">receiver</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"has withdrawn"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> symbol</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"from the"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> sender</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"Exchange Wallet"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">elif</span><span class="token plain"> receiver </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">in</span><span class="token plain"> wallets</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">sender</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"has deposited"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> symbol</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"to the"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> receiver</span><span class="token punctuation" style="color: rgb(248, 248, 242);">,</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"Exchange Wallet"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> DecodeError </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">as</span><span class="token plain"> err</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Protobuf decoding error: </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">err</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">as</span><span class="token plain"> err</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">f"Error processing message: </span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token string-interpolation interpolation">err</span><span class="token string-interpolation interpolation punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token string-interpolation string" style="color: rgb(255, 121, 198);">"</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg viewBox="0 0 24 24" class="wordWrapButtonIcon_Bwma" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="poll-and-monitor-activities-in-real-time">Poll and Monitor Activities in Real Time<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#poll-and-monitor-activities-in-real-time" class="hash-link" aria-label="Direct link to Poll and Monitor Activities in Real Time" title="Direct link to Poll and Monitor Activities in Real Time">​</a></h2><p>This is the main loop for consuming Kafka messages and monitoring the exchange wallets activities in real time.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">while</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        msg </span><span class="token operator">=</span><span class="token plain"> consumer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">poll</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">timeout</span><span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> msg </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> msg</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">error</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> msg</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">error</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">code</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> KafkaError</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">_PARTITION_EOF</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">            </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">else</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">                </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">raise</span><span class="token plain"> KafkaException</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">msg</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">error</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">        process_message</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">msg</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">except</span><span class="token plain"> KeyboardInterrupt</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">print</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token string" style="color: rgb(255, 121, 198);">"\nStopping consumer..."</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">finally</span><span class="token punctuation" style="color: rgb(248, 248, 242);">:</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    consumer</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token plain">close</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-script">Running the Script<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#running-the-script" class="hash-link" aria-label="Direct link to Running the Script" title="Direct link to Running the Script">​</a></h2><p>Run this command line to run the <code>main.py</code> script.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #F8F8F2; --prism-background-color: #282A36;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">python main.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-result">Final Result<a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#final-result" class="hash-link" aria-label="Direct link to Final Result" title="Direct link to Final Result">​</a></h2><p><img loading="lazy" alt="Final Results of Project" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/result-d7901e628642650d4c57e90bdceeb196.png" width="2170" height="1014" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bitquery/streaming-data-platform-docs/tree/main/docs/usecases/binance-exchange-wallet-monitoring.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="https://docs.bitquery.io/docs/category/building-applications-using-kafka/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Building Applications Using Kafka</div></a><a class="pagination-nav__link pagination-nav__link--next" href="https://docs.bitquery.io/docs/usecases/track-millions-of-solana-wallets/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to efficiently track millions of Solana Wallets Balance with Bitquery Kafka Streams</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#helper-functions" class="table-of-contents__link toc-highlight">Helper Functions</a><ul><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#convert-bytes" class="table-of-contents__link toc-highlight">Convert Bytes</a></li></ul></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#imports" class="table-of-contents__link toc-highlight">Imports</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#creating-kafka-configuration" class="table-of-contents__link toc-highlight">Creating Kafka Configuration</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#creating-consumer-and-subcribing-to-topic" class="table-of-contents__link toc-highlight">Creating Consumer and Subcribing to Topic</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#creating-set-of-binance-exchange-wallets" class="table-of-contents__link toc-highlight">Creating Set of Binance Exchange Wallets</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#proccess-message-function" class="table-of-contents__link toc-highlight">Proccess Message Function</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#poll-and-monitor-activities-in-real-time" class="table-of-contents__link toc-highlight">Poll and Monitor Activities in Real Time</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#running-the-script" class="table-of-contents__link toc-highlight">Running the Script</a></li><li><a href="https://docs.bitquery.io/docs/usecases/binance-exchange-wallet-monitoring/#final-result" class="table-of-contents__link toc-highlight">Final Result</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://bitquery.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://docs.bitquery.io/v1/" target="_blank" rel="noopener noreferrer" class="footer__link-item">V1 Docs</a></li><li class="footer__item"><a class="footer__link-item" href="https://docs.bitquery.io/docs/intro/">V2 Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/Bloxy_info" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Bitquery_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://community.bitquery.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/bitquery" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://bitquery.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Bitquery, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/runtime~main.94f1a4d2.js.Без названия"></script>
<script src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/main.19751415.js.Без названия"></script>

<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>


<div class="go2933276541 go2369186930" id="hs-web-interactives-top-anchor"><div id="hs-interactives-modal-overlay" class="go1632949049"></div></div>
<div class="go2933276541 go1348078617" id="hs-web-interactives-bottom-anchor"></div>
<div id="hs-web-interactives-floating-container">
  <div id="hs-web-interactives-floating-top-left-anchor" class="go2417249464 go613305155">
  </div>
  <div id="hs-web-interactives-floating-top-right-anchor" class="go2417249464 go471583506">
  </div>
  <div id="hs-web-interactives-floating-bottom-left-anchor" class="go2417249464 go3921366393">
  </div>
  <div id="hs-web-interactives-floating-bottom-right-anchor" class="go2417249464 go3967842156">
  </div>
</div>
<style>
#chatbase-bubble-button,
#chatbase-bubble-button * {
margin: 0;
padding: 0;
box-sizing: border-box;
}
html.__cb_widget_active,
html.__cb_widget_active body {
position: fixed !important;
top: 0;
left: 0;
overscroll-behavior: none;
width: 0 !important;
height: 0 !important;
margin: 0 !important;
overflow: hidden !important;
overflow-y: hidden !important;
overflow-x: hidden !important;
transform: none !important;
}

#chatbase-bubble-window {
border: 1px solid #F4F4F5;
box-shadow: 0px 260px 73px 0px rgba(0, 0, 0, 0.00), 0px 166px 67px 0px rgba(0, 0, 0, 0.01), 0px 94px 56px 0px rgba(0, 0, 0, 0.02), 0px 42px 42px 0px rgba(0, 0, 0, 0.03), 0px 10px 23px 0px rgba(0, 0, 0, 0.04);
backdrop-filter: blur(4px);
-webkit-backdrop-filter: blur(4px);
}

</style><div id="chatbase-message-bubbles" style="position: fixed; bottom: 85px; border-radius: 10px; font-family: sans-serif; font-size: 16px; z-index: 2147483644; cursor: pointer; flex-direction: column; gap: 50px; max-width: 70vw; display: none; right: 1rem; left: unset;"><div style="position: absolute; top: -7px; right: -7px; font-weight: bold; display: none; justify-content: center; align-items: center; z-index: 2147483643; width: 22px; height: 22px; border-radius: 50%; text-align: center; font-size: 12px; cursor: pointer; background-color: rgb(224, 224, 224); color: black; box-shadow: rgba(150, 150, 150, 0.15) 0px 6px 24px 0px, rgba(150, 150, 150, 0.15) 0px 0px 0px 1px;">✕</div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">Which Query or API can I help you build? (Please mention the blockchain name and be precise)</div></div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">For additional questions, please contact us on Telegram (https://t.me/Bloxy_info)</div></div><div style="display: flex; justify-content: flex-end;"><div style="background-color: white; color: black; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; border-radius: 10px; padding: 20px; margin: 8px; font-size: 14px; opacity: 0; transform: scale(0.9); transition: opacity 0.5s, transform 0.5s;">Note that this chat only answer questions about API v2 and API EAP. For questions on API v1 please select appropriate API endpoint from the list in IDE.</div></div></div><iframe allow="join-ad-interest-group" data-tagging-id="AW-11376996312" data-load-time="1752165324304" height="0" width="0" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/11376996312.html" style="display: none; visibility: hidden;"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/saved_resource.html"></iframe><button type="button" id="chatbase-bubble-button" aria-label="chat-button" style="position: fixed; border: 0px; bottom: 1rem; right: 1rem; width: 55px; height: 55px; border-radius: 27.5px; background-color: rgb(144, 19, 254); box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px 0px; cursor: pointer; z-index: 2147483645; transition: 0.2s ease-in-out; left: unset; transform: scale(1);"><div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; z-index: 2147483646;"><svg width="55" height="55" viewBox="0 0 1120 1120" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M252 434C252 372.144 302.144 322 364 322H770C831.856 322 882 372.144 882 434V614.459L804.595 585.816C802.551 585.06 800.94 583.449 800.184 581.405L763.003 480.924C760.597 474.424 751.403 474.424 748.997 480.924L711.816 581.405C711.06 583.449 709.449 585.06 707.405 585.816L606.924 622.997C600.424 625.403 600.424 634.597 606.924 637.003L707.405 674.184C709.449 674.94 711.06 676.551 711.816 678.595L740.459 756H629.927C629.648 756.476 629.337 756.945 628.993 757.404L578.197 825.082C572.597 832.543 561.403 832.543 555.803 825.082L505.007 757.404C504.663 756.945 504.352 756.476 504.073 756H364C302.144 756 252 705.856 252 644V434ZM633.501 471.462C632.299 468.212 627.701 468.212 626.499 471.462L619.252 491.046C618.874 492.068 618.068 492.874 617.046 493.252L597.462 500.499C594.212 501.701 594.212 506.299 597.462 507.501L617.046 514.748C618.068 515.126 618.874 515.932 619.252 516.954L626.499 536.538C627.701 539.788 632.299 539.788 633.501 536.538L640.748 516.954C641.126 515.932 641.932 515.126 642.954 514.748L662.538 507.501C665.788 506.299 665.788 501.701 662.538 500.499L642.954 493.252C641.932 492.874 641.126 492.068 640.748 491.046L633.501 471.462Z" fill="white"></path>
<path d="M771.545 755.99C832.175 755.17 881.17 706.175 881.99 645.545L804.595 674.184C802.551 674.94 800.94 676.551 800.184 678.595L771.545 755.99Z" fill="white"></path>
</svg>            
</div></button><div id="chatbase-bubble-window" style="border: none; position: fixed; flex-direction: column; justify-content: space-between; bottom: 85px; right: 1rem; width: 406px; height: 85dvh; max-height: 824px; border-radius: 1.25rem; display: none; z-index: 2147483646; overflow: hidden; background-color: white; left: unset;"><div style="display: none; justify-content: center; height: 100%; align-items: center;"><svg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" stroke="black" style="width:30px;height:30px;">
  <g>
      <rect x="11" y="1" width="2" height="5" opacity=".14"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(30 12 12)" opacity=".29"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(60 12 12)" opacity=".43"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(90 12 12)" opacity=".57"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(120 12 12)" opacity=".71"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(150 12 12)" opacity=".86"></rect>
      <rect x="11" y="1" width="1" height="5" transform="rotate(180 12 12)"></rect>
      <animatetransform attributeName="transform" type="rotate" calcMode="discrete" dur="0.75s" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12" repeatCount="indefinite"></animatetransform>
  </g>
</svg></div><iframe title="Chatbot" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/Vz0cwoEYRJW6n5B2JeSeu.html" style="height: 100%; width: 100%; border: none; display: block;"></iframe></div>
<script id="hs-script-loader" text="" charset="" type="text/javascript" src="./Monitoring Withdrawals and Deposits for 1000s of Binance Exchange Wallets _ Blockchain Data API (V2)_files/6314272(1).js.Без названия"></script>
</body></html>