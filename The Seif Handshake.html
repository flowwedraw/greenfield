<!DOCTYPE html>
<!-- saved from url=(0035)https://www.crockford.com/seif.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="author" content="Douglas Crockford">
<meta name="copyright" content="(C)2025 Douglas Crockford">
<meta name="date" content="2025">
<meta http-equiv="Expires" content="1968-12-09">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<link rel="stylesheet" href="./The Seif Handshake_files/crockford.css" type="text/css">
<link rel="icon" type="image/png" href="https://www.crockford.com/favicon.png">
<title>The Seif Handshake</title>
</head>
<body>
<div id="side">
    <div id="name"><a href="https://www.crockford.com/"><big>Douglas Crockford</big></a></div><br>
    <p><a href="https://www.crockford.com/blog.html">Blog</a></p>
    <p><a href="https://www.crockford.com/books.html">Books</a></p>
    <p><a href="https://www.crockford.com/videos.html">Videos</a></p>
    <p><a href="https://www.crockford.com/2025.html">2025 Appearances</a></p>
    <p><a href="https://www.crockford.com/slides.html">Slides</a></p>
    <p><a href="https://www.crockford.com/javascript/">JavaScript</a></p>
    <p><a href="https://mistysystem.com/">Misty</a></p>
    <p><a href="https://jslint.com/">JSLint</a></p>
    <p><a href="https://json.org/">JSON</a></p>
    <p><a href="https://github.com/douglascrockford">Github</a></p>
    <p><a href="https://www.crockford.com/ec.html">Electric Communities</a></p>
    <p><a href="https://www.flickr.com/photos/douglascrockford/albums/72157644699201976">Flickr Photo Album</a></p>
    <p><a href="https://www.linkedin.com/in/douglas-crockford-724600109/">LinkedIn</a></p>
    <p><a rel="me" href="https://layer8.space/@douglascrockford">Mastodon/Layer8</a></p>
    <p><a href="https://www.researchgate.net/profile/Douglas-Crockford">ResearchGate</a></p>
    <p><a href="https://www.crockford.com/pronouns.html">Pronouns: <dfn>pe/per</dfn></a></p>
    <p><a href="https://lz953.isrefer.com/go/preorder/B53xn5cY">Aptera</a></p>
    <p><a href="https://www.crockford.com/about.html">About</a></p>
</div>
<div id="blog">
<time>2019-06-01</time>
<h1>The Seif Handshake</h1>

<img src="./The Seif Handshake_files/seif.gif" align="right">
<p>The World Wide Web does an adequate job of document retrieval, but it has deficiencies when viewed as an application delivery system, being cursed with weaknesses in functionality and security. <a href="http://www.seif.space/">The Seif Project</a> intends to remedy that.</p>
<p>The Seif Protocol is a message delivery system using secure <a href="https://www.json.org/">JSON</a> over TCP/IP. The Seif Handshake is the part of the protocol that establishes a secure session between two parties.</p>
<p>The Seif System assumes that every party has a pair of keys: a Public Key that acts as the party's globally unique identifier, and a closely held Private Key  that is shared with no one. Information that is encrypted with the Public Key can only be decrypted with the corresponding Private Key. It is by the act of decryption that a party can prove that they are the holder of the Public Key.</p>
<p>Alice wants to connect with Bob. Before the session begins, Alice has her key pair (<code>alice_public_key</code>, <code>alice_private_key</code>). She also has Bob's Public Key  (<code>bob_public_key</code>) and Bob's network address. Bob has his own key pair (<code>bob_public_key</code>, <code>bob_private_key</code>). Bob might have <code>alice_public_key</code> if they have a pre-existing relationship, but Bob might not know that Alice is about to connect.</p>
<h2>Alice's Message</h2>
<p>Alice generates a random <code>handshake_key</code>.</p>
<p>Alice's first message is sent in the clear, but it contains some encrypted components. It is sent to Bob's network address.</p>
<pre>{
    "seif": 1,
    "handshake": encrypt_pk(bob_public_key, handshake_key),
    "payload": encrypt(handshake_key, alice_public_key)
}</pre>

<p>The <code>seif</code> property indicates that this is a Seif Protocol handshake. The <code>1</code> indicates the version number of the Seif Protocol. This allows us to adapt the protocol over time. For example, if the cryptographic system proves to be too weak, the <code>seif</code> version can be advanced to a stronger system.</p>
<p>The message contains Alice's random <code>handshake_key</code> encrypted with <code>bob_public_key</code>. Only Bob can recover the <code>handshake_key</code>.</p>
<p>The payload contains <code>alice_public_key</code> encrypted with the <code>handshake_key</code>. This allows Bob to know who is attempting to connect. Encrypting <code>alice_public_key</code> provides a little bit of privacy, but traffic analysis could probably determine who Alice is, even without obtaining the use of <code>handshake_key</code>.</p>
<p>Alice's message could contain other information encrypted with <code>handshake_key</code>, such as a referral code or a request or routing information.</p>
<h2>Bob's Message</h2>
<p>Bob received Alice's message. Bob generates a random <code>session_key</code> that will be used as a symmetric session encryption key for future messages.</p>
<p>Bob's first message is encrypted with Alice's <code>handshake_key</code>.</p>
<pre>encrypt(handshake_key, {"session": encrypt_pk(alice_public_key, <code>session_key</code>)})</pre>
<p>Bob's message contains <code>session_key</code> encrypted with <code>alice_public_key</code>. All subsequent messages sent by Alice and Bob will be encrypted by <code>session_key</code>.</p>
<p>Bob's message could contain other information. </p>
<p>Alice has <code>handshake_key</code> so she can decrypt the message, and she has <code>alice_private_key</code> so she can decrypt <code>session_key</code>.</p>
<p>Bob can send <code>session_key</code>-encrypted messages immediately. Bob does not have to wait for Alice to send a second message.</p>
<h2>Properties</h2>
<p>The Seif Handshake has some nice properties:</p>
<p>Given an underlying network connection, a secure session is set up with one round trip.</p>
<p>A man-in-the-middle  requires knowledge of both Private Keys.</p>
<p>Forward secrecy for the session is retained as long as either Private Key  is kept private.</p>
<p>Alice and Bob have both proven that they hold their Private Keys. For many applications no additional authentication is required.</p>
<h2>Discussion</h2>
<p>The Seif Handshake does some obvious things with Public Key  Cryptography. So why haven't we seen this before? </p>
<p>Public Keys  are an excellent alternative to user names and passwords. While it is well understood that passwords work poorly for humans at scale, there has been a strong reluctance to consider better alternatives.</p>
<p>The  World Wide Web has been remarkably influential. There are patterns of thought that are enforced by the Web. After a few decades, non-web thinking has become very difficult. For example, there is the problem of how Alice acquires <code>bob_public_key</code>. Netscape chose to have Bob provide <code>bob_public_key</code> in response to Alice's attempt to connect, along with certification that Alice should trust this highly dubious process. This might have made sense in 1995, but today we have much better options for distribution of Public Keys. The old constraints are hard to give up, so it is difficult for many security practitioners to imagine a secure system that does not rely on PKI certificate authorities, despite the experience that certificate authorities are not reliable.</p>
<p>In 1995 Public Key operations were computationally prohibitively expensive. Yahoo did not start using SSL at scale until 2006 because it could not afford the computation. So something like the Seif Handshake that requires <i>two</i> Public Key operations seems unimaginable. But three fundamental things have changed since then. Moore's Law has continued to reduce the cost of cryptography, and we now have Elliptic Curve Cryptography, which offers cryptographic strength at a significantly lower cost, and we have specialized hardware. In today's technology, it is now feasible for all devices to do two Public Key  operations on setting up a session. The cost of computation is more than compensated for by the elimination of network round trips.</p>
<h5><a href="https://github.com/paypal/seif-protocol/blob/master/seif-protocol-specification.pdf">The Seif Protocol</a></h5>
  <h5><a href="https://github.com/paypal/seifnode">Seifnode Source (Github)</a></h5>
  <h5><a href="https://github.com/paypal/seif-protocol">Seif Protocol Source (Github)</a></h5>
  <h5><a href="https://github.com/jamesdiacono/WebSeif">WebSeif</a></h5>

</div>



</body></html>